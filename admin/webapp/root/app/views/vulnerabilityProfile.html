<div
  ng-controller="VulnerabilityProfileController"
>
  <!-- <div class="mt" style="min-height: 139px;">
    <div class="text-bold">Find out matching profile</div>
    <hr class="fancy mv-sm" />
    <div layout="row">
      <div flex="20" class="pl-lg mt" uib-dropdown>
        <div uib-dropdown-toggle>
          <div>
            <label class="text-muted hand">{{advFilter.entityType}}</label>
            <em
              class="fa fa-caret-down text-action ml-sm"
              ng-click="toggleCollapse()"
            ></em>
          </div>
        </div>
        <ul
          class="dropdown-menu"
          uib-dropdown-menu
          role="menu"
          aria-labelledby="single-button"
        >
          <li role="menuitem" ng-repeat="entity in advFilter.entities">
            <a ng-click="setEntity(entity)">{{entity}}</a>
          </li>
        </ul>
      </div>
      <div flex="10" ng-show="advFilter.entityType === 'Reported within'">
        <label class="text-gray-label mr" style="margin-top: 12px;">
          =
        </label>
      </div>
      <div flex="10" uib-dropdown style="margin-top: 10px" ng-show="advFilter.entityType !== 'Reported within'">
        <div uib-dropdown-toggle>
          <div>
            <label class="text-gray-label hand"
            >{{advFilter.matchType.name}}</label
            >
            <em
              class="fa fa-caret-down text-action ml-sm"
              ng-click="toggleCollapse()"
            ></em>
          </div>
        </div>
        <ul
          class="dropdown-menu"
          uib-dropdown-menu
          role="menu"
          aria-labelledby="single-button"
        >
          <li role="menuitem" ng-repeat="matchType in matchTypes">
            <a ng-click="setMatchType(matchType)">{{matchType.name}}</a>
          </li>
        </ul>
      </div>
      <div
        flex="60"
        class="text-bold text-muted"
        ng-if="advFilter.entityType==='Vulnerability Name'"
      >
        <md-input-container class="md-block mt0 mb0" md-no-float="">
          <input
            ng-model="advFilter.vulnerabilityName"
            maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
          />
        </md-input-container>
      </div>
      <div
        flex="60"
        class="text-bold text-muted"
        ng-if="advFilter.entityType==='Reported within'"
      >
        <md-input-container class="md-block mt0 mb0" md-no-float="">
          <input
            ng-model="advFilter.reportedWithin"
            maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
          />
        </md-input-container>
      </div>
      <div
        flex="60"
        class="text-bold text-muted"
        ng-if="advFilter.entityType==='Image'"
      >
        <md-input-container class="md-block mt0 mb0" md-no-float="">
          <input
            ng-model="advFilter.imageName"
            maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
          />
        </md-input-container>
      </div>
      <div
        flex="60"
        class="text-bold text-muted"
        ng-if="advFilter.entityType==='Domain'"
      >
        <md-input-container class="md-block mt0 mb0" md-no-float="">
          <input
            ng-model="advFilter.domainName"
            maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
          />
        </md-input-container>
      </div>
      <div flex="10" class="mt" style="margin-left: 45px">
        <em
          class="fa fa-plus pl-lg text-action"
          ng-click="setEntityName()"
        ></em>
      </div>
    </div>
    <md-content
      class=""
      layout="column"
      style="background-color: transparent"
      ng-if="entities.length"
    >
      <md-chips ng-model="entities" md-on-remove="removeEntity($chip)">
        <md-chip-template>
          <strong class="text-muted mr-sm">{{$chip.name}}</strong>
        </md-chip-template>
      </md-chips>
    </md-content>
  </div> -->
  <div class="panel mb0">
    <div class="panel-body">
      <md-content style="padding-bottom: 0;">
        <div class="pull-left" style="margin-top: 2px;">
          <label class="text-primary mr" ng-show="!controllerErr"
            >{{count}}</label
          >
          <button
            type="button"
            style="padding: 3px 15px;"
            class="btn btn-default btn-wide"
            display-control="write_vuls_profile"
            ng-click="addCveProfile()"
          >
            <em class="fa fa-plus-circle mr-sm text-action" aria-hidden="true"></em>
            {{'role.ADD' | translate}}
          </button>
        </div>
        <div class="pull-right" style="padding-top: 5px; margin-left: 10px;" ng-click="refresh(); ">
            <em class="fa fa-refresh text-action hand" aria-hidden="true"/>
            <label class="text-gray-label hand">{{'general.REFRESH' | translate}}</label>
        </div>
        <div class="left-inner-addon pull-right" style="margin-bottom: 10px">
          <em class="fa fa-filter text-filter"></em>
          <input class="search form-control" placeholder="{{'general.FILTER' | translate}}" type="text" maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
                 ng-model="search"
                 ng-paste="onFilterChanged(search)"
                 ng-keyup="onFilterChanged(search)"/>
        </div>
      </md-content>
      <md-content style="padding-bottom: 0;">
        <div
          ag-grid="gridOptions4CveProfile"
          class="ag-grid mt-sm"
          style="width: 100%;"
          ng-style="{'height': gridHeight + 'px'}"
        ></div>
      </md-content>
    </div>
  </div>

  <!--Add/Edit vulnerability profile-->
  <script type="text/ng-template" id="dialog.addEditCveProfile.html">
    <md-dialog aria-label="Add edit vulnerability profile" class="dialog-lg" style="overflow: visible; max-height: none;">
        <form name="addEditVulneerabilityProfileForm" ng-submit="$event.preventDefault()" novalidate="" class="form-validate" style="overflow: visible">
            <md-toolbar>
                <div class="md-toolbar-tools">
                    <h2 class="text-dark">{{(isEdit ? 'cveProfile.EDIT_CVE_PROFILE' : 'cveProfile.ADD_CVE_PROFILE') | translate}}</h2>
                    <span flex></span>
                    <md-button class="md-icon-button" ng-click="cancel()">
                        <md-icon md-svg-src="app/img/icons/ic_close_24px.svg" aria-label="Close dialog"></md-icon>
                    </md-button>
                </div>
            </md-toolbar>
            <div>
              <div class="pull-left ml-lg mr" style="margin-top: 25px;">
                <div uib-dropdown>
                  <div uib-dropdown-toggle>
                    <div>
                      <label class="text-muted hand">{{vulnerabilityFilterType}}</label>
                      <em
                        class="fa fa-caret-down text-action ml-sm"
                        ng-click="toggleCollapse()"
                      ></em>
                    </div>
                  </div>
                  <ul
                    class="dropdown-menu"
                    uib-dropdown-menu
                    role="menu"
                    aria-labelledby="single-button"
                  >
                    <li role="menuitem">
                      <a ng-click="setVulnerabilityFilterType('vul_name')">{{'cveProfile.gridHeader.VULNERABILITY' | translate}}</a>
                    </li>
                    <li role="menuitem">
                      <a ng-click="setVulnerabilityFilterType('days')">{{'cveProfile.gridHeader.REPORTED_DAYS' | translate}}</a>
                    </li>
                    <li role="menuitem">
                      <a ng-click="setVulnerabilityFilterType('days_without_fix')">{{'cveProfile.gridHeader.REPORTED_DAYS_WITHOUT_FIX' | translate}}</a>
                    </li>
                  </ul>
                </div>
              </div>
              <md-input-container class="md-block mb0 pull-left">
                <input ng-model="cveProfile.vulnerabilityFilter"
                       class="mda-form-control" maxlength="{{'general.FILTER_MAX_LEN' | translate}}"/>
              </md-input-container>
            </div>
            <md-dialog-content style="overflow: visible">
              <div class="row m0">
                <div class="col-sm-12">
                  <md-input-container class="md-block mb0" >
                    <label>{{'cveProfile.gridHeader.COMMENT' | translate}}</label>
                    <input ng-model="cveProfile.comment"
                           class="mda-form-control" maxlength="{{'general.FILTER_MAX_LEN' | translate}}"/>
                  </md-input-container>
                </div>
              </div>
              <div class="row m0">
                <div class="col-sm-12 mb-sm mt-sm">
                  <div class="form-group" >
                    <label class="col-sm-2 nv-modal-item-title control-label pl0" style="padding-left: 36px;">
                      {{'cveProfile.gridHeader.IMAGES' | translate}}
                      <div class="text-sm text-muted">{{'cveProfile.TAGS_INPUT_TIP' | translate}}</div>
                    </label>
                    <div class="col-sm-10  pr0">
                      <tags-input id="images" ng-model="cveProfile.images" placeholder="{{'cveProfile.IMAGES_PLACEHOLDER' | translate}}"
                                  display-property="name" add-from-autocomplete-only="false" class="nv-input-text"
                                  on-tag-clicked="showTagDetail($tag, 'images')"
                                  on-tag-adding="tagAdding($tag, 'images')"
                                  on-tag-removing="tagRemoving($tag, 'images')"
                                  max-length="{{'general.FILTER_MAX_LEN' | translate}}">
                      </tags-input>
                      <div ng-show="isShowingEditCriterion['images']">
                        <div class="col-sm-11 pl0">
                          <div class="md-block mb0">
                            <input id="tagEditor" ng-model="singleTag.value" placeholder="{{'group.SINGLE_CRITERION_HINT' | translate}}"
                                   class="mda-form-control" maxlength="{{'general.FILTER_MAX_LEN' | translate}}" ng-keyup="checkDuplicated('images')" ng-keydown="preventFormSubmit($event)"/>
                          </div>
                        </div>
                        <div class="col-sm-1 pr0">
                          <md-button class="fa fa-pencil-square-o md-raised md-primary pull-right mr0" aria-hidden="true" style="min-width: 36px; margin-top: -3px;" aria-hidden="true" ng-click="editCriterion(singleTag, 'images')"
                                     ng-disabled="singleTag.value.length===0 || isInvalidTag">
                          </md-button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row m0">
                <div class="col-sm-12 mb-sm mt-sm">
                  <div class="form-group" >
                    <label class="col-sm-2 nv-modal-item-title control-label pl0" style="padding-left: 36px;">
                      {{'cveProfile.gridHeader.DOMAINS' | translate}}
                      <div class="text-sm text-muted">{{'cveProfile.TAGS_INPUT_TIP' | translate}}</div>
                    </label>
                    <div class="col-sm-10  pr0">
                      <tags-input id="domains" ng-model="cveProfile.domains" placeholder="{{'cveProfile.DOMAINS_PLACEHOLDER' | translate}}"
                                  display-property="name" add-from-autocomplete-only="false" class="nv-input-text"
                                  on-tag-clicked="showTagDetail($tag, 'domains')"
                                  on-tag-adding="tagAdding($tag, 'domains')"
                                  on-tag-removing="tagRemoving($tag, 'domains')"
                                  max-length="{{'general.FILTER_MAX_LEN' | translate}}">
                        <auto-complete source="loadTags4Domains($query)" min-length="1" ></auto-complete>
                      </tags-input>
                      <div ng-show="isShowingEditCriterion['domains']">
                        <div class="col-sm-11 pl0">
                          <div class="md-block mb0">
                            <input id="tagEditor" ng-model="singleTag.value" placeholder="{{'group.SINGLE_CRITERION_HINT' | translate}}"
                                   class="mda-form-control" maxlength="{{'general.FILTER_MAX_LEN' | translate}}" ng-keyup="checkDuplicated('domains')" ng-keydown="preventFormSubmit($event)"/>
                          </div>
                        </div>
                        <div class="col-sm-1 pr0">
                          <md-button class="fa fa-pencil-square-o md-raised md-primary pull-right mr0" aria-hidden="true" style="min-width: 36px; margin-top: -3px;" aria-hidden="true" ng-click="editCriterion(singleTag, 'domains')"
                                     ng-disabled="singleTag.value.length===0 || isInvalidTag">
                          </md-button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </md-dialog-content>
            <div class="md-actions" layout="row" style="border: 0;">
                <md-button ng-click="addEditCveProfile(ev)" class="md-raised md-primary"
                           ng-disabled="addEditVulneerabilityProfileForm.$invalid">
                    {{(isEdit? 'cveProfile.UPDATE' : 'cveProfile.ADD') | translate}}
                </md-button>
                <a ng-click="cancel()" class="nv-link">
                    {{'cveProfile.CANCEL' | translate}}
                </a>
            </div>
        </form>
    </md-dialog>
  </script>
</div>
