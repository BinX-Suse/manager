<div id="sec-event" ng-controller="SecurityEventsController" class="pt0">
  <div
    style="visibility: hidden; position: absolute; top: -1000px; left: 1000px;  width:1150px; height:600px;"
  >
    <canvas
      id="byEventType"
      class="chart chart-horizontal-bar"
      chart-data="eventTypeChartData"
      chart-labels="eventTypeChartLabels"
      chart-colors="eventTypeChartColors"
      chart-options="eventTypeChartOptions"
    >
    </canvas>
  </div>

  <div
    class="nv-scroll-mask"
    ng-show="isAllFilesShown || onPacketPreview"
    ng-click="hideAllFiles()"
  ></div>
  <div class="clearfix">
    <div
      class="pull-right mt-sm"
      style="padding-top: 5px; margin-left: 10px; width: 100px; text-align: right;"
      ng-click="refresh()"
    >
      <em class="fa fa-refresh text-action hand" />
      <label class="text-gray-label hand"
        >{{'general.REFRESH' | translate}}</label
      >
    </div>

    <div
      class="mt-sm pull-right text-muted ml"
      style="padding-top: 5px; margin-left: 10px; text-align: right; position: relative;"
      ng-if="!isPdfPreparing && rangedSecEvents.length>0 && !secEventsErr"
    >
      <!--<em class="fa fa-file-text text-action"/>-->
      <!--<span class="text-gray-label">{{'general.REPORT_DOWNLOAD' | translate}}</span>-->
      <span ng-if="progress<100">
        <em class="fa fa-file-pdf-o disabled" style="margin-left:10px;"></em>
        <span class="text-disabled-label disabled">PDF</span>
        <div class="loader5" style="position: absolute; top: 10px; left: 30px;"></div>
        <div style="position: absolute; top: 6px; left: 22px; font-size: 12px; color: #11330f">{{progress}}%</div>
      </span>
      <span ng-if="progress===100" ng-click="downloadPdf()">
        <em
          class="fa fa-file-pdf-o pdf-color hand"
          style="margin-left:10px;"
        ></em>
        <span class="text-gray-label link">PDF</span>
      </span>
      <span ng-click="downloadCsv()">
        <em
          class="fa fa-file-excel-o xls-color hand"
          style="margin-left:10px;"
        ></em>
        <span class="text-gray-label link">CSV</span>
      </span>
    </div>
    <div
      class="mt-sm pull-right ml"
      style="color: rgba(144, 159, 167, .4); position: relative; padding-top: 5px; margin-left: 10px; text-align: right;"
      ng-if="isPdfPreparing && rangedSecEvents.length>0 && !secEventsErr"
    >
      <!--<span class="text-gray-label">{{'general.REPORT_DOWNLOAD' | translate}}</span>-->
      <em class="fa fa-file-pdf-o disabled" style="margin-left:10px;"> </em>
      <span class="text-disabled-label disabled">PDF</span>
      <span ng-click="downloadCsv()">
        <em
          class="fa fa-file-excel-o xls-color hand"
          style="margin-left:10px;"
        ></em>
        <span class="text-gray-label link">CSV</span>
      </span>
      <div
        class="loader5"
        style="position: absolute; top: 12px; left: 25px;"
      ></div>
    </div>
    <div class="content-title">
      {{'sidebar.nav.SECURITY_EVENT' | translate}}
    </div>
  </div>
  <!--panel-->
  <div id="sec-event-panel" class="panel mb0">
    <div class="panel-body" style="position:relative;">
      <!--panel topper-->
      <div class="clearfix">
        <label class="text-primary" ng-show="!secEventsErr">{{count}}</label>
        <div
          class="left-inner-addon pull-right ml-lg"
          style="margin-bottom: 10px"
          ng-if="rangedSecEvents.length>0 && !secEventsErr"
        >
          <em class="fa fa-filter text-filter" />
          <input
            id="quick-filter-text"
            class="search form-control"
            placeholder="{{'general.QUICK_FILTER' | translate}}"
            type="text"
            ng-model="search"
            ng-paste="onFilterChanged('quick', search)"
            ng-keyup="onFilterChanged('quick', search)"
            ng-disabled="isAdvFilterInUse"
          />
        </div>
        <div
          class="left-inner-addon pull-right ml"
          style="margin: 5px auto;"
          ng-click="onAdvFilter=true"
          ng-show="!isOnQuickFilter && rangedSecEvents.length>0 && !secEventsErr"
        >
          <i ng-if="!isAdvFilterInUse" class="fa fa-search text-filter"></i>
          <i ng-if="isAdvFilterInUse" class="fa fa-check text-primary"></i>
          <span
            class="ml-sm text-muted"
            ng-class="{'text-primary': isAdvFilterInUse}"
            >{{'general.ADV_FILTER' | translate}}</span
          >
        </div>
        <div
          class="left-inner-addon pull-right ml disabled"
          style="margin: 5px auto;"
          ng-if="isOnQuickFilter && rangedSecEvents.length>0 && !secEventsErr"
        >
          <i ng-if="!isAdvFilterInUse" class="fa fa-search text-filter"></i>
          <i ng-if="isAdvFilterInUse" class="fa fa-check text-success"></i>
          <span
            class="ml-sm text-muted"
            ng-class="{'text-success': isAdvFilterInUse}"
            >{{'general.ADV_FILTER' | translate}}</span
          >
        </div>
      </div>
      <!--panel content-->
      <div
        ng-if="displayedSecurityEvents.length > 0"
        class="sec-event-top-mask"
      ></div>
      <div
        ng-if="displayedSecurityEvents.length > 0"
        class="sec-event-bottom-mask"
      ></div>
      <div ng-if="!isDataReady" class="blur-sec-event"></div>
      <div
        ng-if="isDataReady && displayedSecurityEvents.length > 0"
        style="height: 65px;"
      >
        <div class="mb-sm">
          <canvas style="height: 45px;" id="line" class="chart chart-line"
            chart-data="sparklingLineData" chart-labels="sparklingLineLabels" chart-colors="sparklingLineColors" chart-options="sparklingLineOptions" chart-dataset-override="sparklingLineDatasetOverride">
          </canvas>
        </div>
        <div class="security-event-slider">
          <rzslider
            rz-slider-model="slider.minValue"
            rz-slider-high="slider.maxValue"
            rz-slider-options="slider.options"
            style="top: -35px"
          >
          </rzslider>
        </div>
      </div>

      <div
        ng-if="isDataReady && !secEventsErr && displayedSecurityEvents.length > 0"
        id="sec-event-list"
        ng-if="isDataReady"
        class="timeline-nv normal"
        two-way-infinite-scroll
      >
        <div ng-show="loadingPacket" class="overlay loading-grid">
          {{'enum.LOADING' | translate}}......
        </div>
        <ul id="timeline">
          <li
            class="sec-event-row"
            id="sec-wrap-{{$index}}"
            ng-repeat="secEvent in filteredSecEvents | limitTo:limit:begin track by $index"
            two-way-infinite-scroll
            ng-mouseup="keepAlive()"
          >
            <input
              class="radio"
              id="sec-{{$index}}"
              name="secEvt"
              type="radio"
              ng-model="isOpened"
              ng-click="getOpenedRec($event, $index, page)"
            />
            <div class="relative">
              <label for="sec-{{$index}}">
                <div class="heading">
                  <div class="row mr0">
                    <div class="col-sm-7 pl0">
                      <div
                        class="sec-event-name pl0 auto-hide"
                        uib-tooltip="{{secEvent.name}}"
                        tooltip-enable="false"
                        show-tooltip-on-text-overflow
                      >
                        <span
                          class="pull-left mt-3"
                          aria-hidden="true"
                          ng-class="secEvent.type.cssColor"
                        ></span>
                        <strong>{{secEvent.name}}</strong>
                      </div>
                    </div>
                    <div class="col-sm-3 pl0 label-wrap">
                      <span
                        class="severity-label mr0"
                        ng-class="secEvent.details.level.cssColor"
                        >{{"enum." + secEvent.details.level.name.toUpperCase() |
                        translate}}</span
                      >
                      <span
                        class="severity-label label-primary"
                        ng-repeat="label in secEvent.details.labels"
                        >{{"securityEvent.label." + label.toUpperCase() |
                        translate}}</span
                      >
                      <span
                        class="severity-label label-muted"
                        ng-if="secEvent.details.labels.length===0"
                        >{{"securityEvent.label.OTHER" | translate}}</span
                      >
                      <div class="sec-event-right-mask"></div>
                    </div>
                    <div
                      class="col-sm-2 sec-event-time text-muted pl0 auto-hide"
                      uib-tooltip="{{secEvent.reportedAt}}"
                      tooltip-enable="false"
                      show-tooltip-on-text-overflow
                    >
                      <span>{{secEvent.reportedAt}}</span>
                    </div>
                  </div>
                  <div
                    ng-show="secEvent.endpoint.source.id && secEvent.endpoint.destination.id"
                  >
                    <div class="row mr0">
                      <div
                        class="col-sm-10 pl0 auto-hide"
                        uib-tooltip="{{secEvent.endpoint.source.displayName}}"
                        tooltip-enable="false"
                        show-tooltip-on-text-overflow
                      >
                        <strong>{{"securityEvent.SOURCE" | translate}}:</strong>
                        <span>
                          <span ng-if="secEvent.endpoint.source.id==='external'">
                            <a
                              href="{{secEvent.endpoint.source.externalURL}}"
                              target="_blank"
                            >
                              <em
                                class="fa text-primary"
                                ng-class="secEvent.endpoint.source.icon"
                              ></em>
                              <span>
                                {{secEvent.endpoint.source.displayName}}
                              </span>
                              (
                                <countryflag ng-if="secEvent.endpoint.source.countryCode!=='-'"
                                             country="{{secEvent.endpoint.source.countryCode}}"
                                             uib-tooltip="{{secEvent.endpoint.source.countryName}}">

                                </countryflag>&nbsp;
                                <span>{{secEvent.endpoint.source.ip}}</span>
                              )
                            </a>
                          </span>
                        </span>
                        <span ng-if="secEvent.endpoint.source.id!=='external'">
                          <span ng-if="secEvent.endpoint.source.domain">
                            <em class="fa text-primary fa-building-o"></em>
                            <span>
                              {{secEvent.endpoint.source.domain}}
                            </span>
                          </span>
                          <span ng-if="secEvent.endpoint.source.service">
                            <em class="fa text-primary fa-th-large"></em>
                            <span>
                              {{secEvent.endpoint.source.service}}
                            </span>
                          </span>
                          <em
                            class="fa text-primary"
                            ng-class="secEvent.endpoint.source.icon"
                          ></em>
                          <span class="link" ng-if="secEvent.endpoint.source.hasDetail && secEvent.endpoint.source.isHyperlinkEnabled"
                                ng-click="showContainerDetails($event, secEvent.endpoint.source, secEvent.host_name)">
                            {{secEvent.endpoint.source.displayName}}
                          </span>
                          <span ng-if="!secEvent.endpoint.source.hasDetail || !secEvent.endpoint.source.isHyperlinkEnabled">
                            {{secEvent.endpoint.source.displayName}}
                          </span>
                        </span>
                      </div>
                      <div
                        ng-if="secEvent.details.action"
                        class="col-sm-2 pl0 auto-hide"
                        uib-tooltip="{{secEvent.details.action.name}}"
                        tooltip-enable="false"
                        show-tooltip-on-text-overflow
                      >
                        <strong
                          >{{"threat.gridHeader.ACTION" | translate}}:</strong
                        >&nbsp;&nbsp;
                        <span
                          class="type-label sec-event-action-label"
                          ng-class="secEvent.details.action.cssColor"
                          >{{secEvent.details.action.name}}</span
                        >
                      </div>
                    </div>
                    <div class="row mr0">
                      <div
                        class="col-sm-10 pl0 auto-hide"
                        uib-tooltip="{{secEvent.endpoint.destination.displayName}}"
                        tooltip-enable="false"
                        show-tooltip-on-text-overflow
                      >
                        <strong
                          >{{"securityEvent.DESTINATION" | translate}}:</strong
                        >
                        <span>
                          <span
                            ng-if="secEvent.endpoint.destination.id==='external'"
                          >
                            <a
                              href="{{secEvent.endpoint.destination.externalURL}}"
                              target="_blank"
                            >
                              <em
                                class="fa text-primary"
                                ng-class="secEvent.endpoint.destination.icon"
                              ></em>
                              <span>
                                {{secEvent.endpoint.destination.displayName}}
                              </span>
                              (
                                <countryflag ng-if="secEvent.endpoint.destination.countryCode!=='-'"
                                             country="{{secEvent.endpoint.destination.countryCode}}"
                                             uib-tooltip="{{secEvent.endpoint.destination.countryName}}">

                                </countryflag>&nbsp;
                                <span>{{secEvent.endpoint.destination.ip}}</span>
                              )
                            </a>
                          </span>
                          <span ng-if="secEvent.endpoint.destination.id!=='external'">
                            <span ng-if="secEvent.endpoint.destination.domain">
                              <em class="fa text-primary fa-building-o"></em>
                              <span>{{secEvent.endpoint.destination.domain}}</span>
                            </span>
                            <span ng-if="secEvent.endpoint.destination.service">
                              <em class="fa text-primary fa-th-large"></em>
                              <span>
                                {{secEvent.endpoint.destination.service}}
                              </span>
                            </span>
                            <em
                              class="fa text-primary"
                              ng-class="secEvent.endpoint.destination.icon"
                            ></em>
                            <span class="link" ng-if="secEvent.endpoint.destination.hasDetail && secEvent.endpoint.destination.isHyperlinkEnabled"
                                  ng-click="showContainerDetails($event, secEvent.endpoint.destination, secEvent.host_name)">
                              {{secEvent.endpoint.destination.displayName}}
                            </span>
                            <span ng-if="!secEvent.endpoint.destination.hasDetail || !secEvent.endpoint.destination.isHyperlinkEnabled">
                              {{secEvent.endpoint.destination.displayName}}
                            </span>
                          </span>
                        </span>
                      </div>
                      <div
                        class="mt-sm col-sm-2 p0"
                        ng-if="secEvent.type.name === 'threat'"
                      >
                        <button
                          ng-if="secEvent.details.message.cap_len"
                          class="btn btn-primary btn-xs btn-sec-event pull-left"
                          style="color: #fff;"
                          ng-click="showPacket(secEvent.details.id, $event)"
                        >
                          <em class="icon-envelope-letter mr-sm"></em>
                          {{"threat.VIEW_PACKET" | translate}}
                        </button>
                      </div>
<!--                      <div class="mt-sm col-sm-2 p0"-->
<!--                        ng-if="secEvent.type.name === 'violation' && isEditRuleAuthorized &&-->
<!--                          (secEvent.endpoint.source.service || secEvent.endpoint.source.id === 'external') &&-->
<!--                          (secEvent.endpoint.destination.service || secEvent.endpoint.destination.id === 'external')">-->
                      <div class="mt-sm col-sm-2 p0"
                           ng-if="secEvent.type.name === 'violation' && isEditRuleAuthorized && secEvent.reviewRulePermission && canShowReviewRule(secEvent)">
                        <button class="btn btn-primary btn-xs btn-sec-event pull-left" style="color: #fff;" ng-click="reviewRule('violation', secEvent)">
                          <em class="fa fa-edit fa-lg mr-sm"></em>
                          {{"securityEvent.REVIEW_RULE" | translate}}
                        </button>
                      </div>
                      <div
                        class="mt-sm col-sm-2 p0"
                        ng-if="secEvent.type.name === 'incident' && secEvent.details.message.group && isEditRuleAuthorized && !isInternalGroup(secEvent.details.message.group) && secEvent.reviewRulePermission"
                      >
                        <button
                          class="btn btn-primary btn-xs btn-sec-event pull-left"
                          style="color: #fff;"
                          ng-if="secEvent.details.message.messageCategory.toLowerCase().indexOf('process') >= 0"
                          ng-click="reviewRule('incident', secEvent)"
                        >
                          <em class="fa fa-edit fa-lg mr-sm"></em>
                          {{"securityEvent.REVIEW_RULE" | translate}}
                        </button>
                      </div>
                    </div>
                  </div>
                  <div
                    class="row mr0"
                    ng-show="!(secEvent.endpoint.source.id && secEvent.endpoint.destination.id)"
                  >
                    <div>
                      <div
                        class="col-sm-2 pl0 auto-hide"
                        uib-tooltip="{{secEvent.host_name}}"
                        tooltip-enable="false"
                        show-tooltip-on-text-overflow
                      >
                        <strong>{{"securityEvent.HOST" | translate}}:</strong>
                        <span class="link" ng-click="showHostDetails($event, secEvent.hostId, secEvent.host_name)">{{secEvent.host_name}}</span>
                      </div>
                      <div
                        ng-if="secEvent.details.action"
                        class="col-sm-offset-8 col-sm-2 pl0 sec-ellipsis-item"
                        tooltip-placement="top-left"
                        uib-tooltip="{{secEvent.details.action.name}}"
                      >
                        <strong
                          >{{"threat.gridHeader.ACTION" | translate}}:</strong
                        >&nbsp;&nbsp;
                        <span
                          class="type-label sec-event-action-label"
                          ng-class="secEvent.details.action.cssColor"
                          >{{secEvent.details.action.name}}</span
                        >
                      </div>
                    </div>
                    <div class="col-sm-10 pl0">
                      <div
                        ng-if="secEvent.container.domain !== ''"
                        class="auto-hide"
                        uib-tooltip="{{secEvent.container.name}}"
                        tooltip-enable="false"
                        show-tooltip-on-text-overflow
                      >
                        <strong
                          >{{"securityEvent.CONTAINER" | translate}}:</strong
                        >
                        <span>
                          <span>
                            <em class="fa text-primary fa-building-o"></em>
                            <span>
                              {{secEvent.container.domain}}
                            </span>
                          </span>
                          <span ng-if="secEvent.container.id !== ''">
                            <span ng-if="secEvent.container.service">
                              <em class="fa text-primary fa-th-large"></em>
                              <span>
                                {{secEvent.container.service}}
                              </span>
                            </span>
                            <em class="fa text-primary fa-square-o"></em>
                            <span class="link" ng-if="secEvent.container.isHyperlinkEnabled"
                              ng-click="showContainerDetails($event, secEvent.container, secEvent.host_name)"
                            >
                              {{secEvent.container.name}}
                            </span>
                            <span ng-if="!secEvent.container.isHyperlinkEnabled">
                              {{secEvent.container.name}}
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                    <div
                      class="mt-sm col-sm-2 p0"
                      ng-if="secEvent.type.name === 'threat'"
                    >
                      <button
                        ng-if="secEvent.details.message.cap_len"
                        class="btn btn-primary btn-xs btn-sec-event pull-left"
                        style="color: #fff;"
                        ng-click="showPacket(secEvent.details.id, $event)"
                      >
                        <em class="icon-envelope-letter mr-sm"></em>
                        {{"threat.VIEW_PACKET" | translate}}
                      </button>
                    </div>
                    <div
                      class="mt-sm col-sm-2 p0"
                      ng-if="secEvent.type.name === 'violation' && isEditRuleAuthorized &&
                          (secEvent.endpoint.source.service || secEvent.endpoint.source.id === 'external') &&
                          (secEvent.endpoint.destination.service || secEvent.endpoint.destination.id === 'external') &&
                          secEvent.reviewRulePermission"
                    >
                      <button
                        class="btn btn-primary btn-xs btn-sec-event pull-left"
                        style="color: #fff;"
                        ng-click="reviewRule('violation', secEvent)"
                      >
                        <em class="fa fa-edit fa-lg mr-sm"></em>
                        {{"securityEvent.REVIEW_RULE" | translate}}
                      </button>
                    </div>
                    <div
                      class="mt-sm col-sm-2 p0"
                      ng-if="secEvent.type.name === 'incident' &&
                      secEvent.details.message.group &&
                      isEditRuleAuthorized &&
                      !isInternalGroup(secEvent.details.message.group)
                      && secEvent.reviewRulePermission"
                    >
                      <button
                        class="btn btn-primary btn-xs btn-sec-event pull-left"
                        style="color: #fff;"
                        ng-if="secEvent.details.message.messageCategory.toLowerCase().indexOf('process') >= 0"
                        ng-click="reviewRule('incident', secEvent)"
                      >
                        <em class="fa fa-edit fa-lg mr-sm"></em>
                        {{"securityEvent.REVIEW_RULE" | translate}}
                      </button>
                    </div>
                  </div>
                </div>
              </label>
              <span class="date">{{secEvent.relativeDate}}</span>
              <span class="circle"></span>
            </div>
            <div class="content">
              <button
                id="detail-close"
                class="btn-link pull-right sec-fixed-close"
                ng-click="closeDetails('sec-' + $index)"
              >
                <em class="fa fa-times" />
              </button>
              <!-- <div ng-include src="currentTpl"></div> -->
              <div
                ng-if="secEvent.type.name.toLowerCase()==='threat'"
                ng-include
                src="currentTpl='threat-details.html'"
              ></div>
              <div
                ng-if="secEvent.type.name.toLowerCase()==='violation'"
                ng-include
                src="currentTpl='violation-details.html'"
              ></div>
              <div
                ng-if="secEvent.type.name.toLowerCase()==='incident'"
                ng-include
                src="currentTpl='incident-details.html'"
              ></div>
            </div>
          </li>
        </ul>
      </div>
      <div
        ng-if="!secEventsErr && displayedSecurityEvents.length === 0"
        class="safe sec-event-safe"
      >
        <div>
          <em class="fa fa-check-circle-o safe-signal" aria-hidden="true"></em>
        </div>
        <div class="safe-text">
          {{'securityEvent.NO_SEC_EVENT' | translate}}
        </div>
      </div>
      <div ng-if="secEventsErr" class="server-error sec-event-server-error">
        <div>
          <em class="fa fa-times-circle error-signal" aria-hidden="true"></em>
        </div>
        <div>
          <span class="error-text">
            {{secEventsMessage}}
          </span>
        </div>
      </div>
    </div>
  </div>
  <!--advanced filter modal-->
  <div
    id="filter"
    class="dataBox advFilter"
    ng-show="onAdvFilter"
    style="border: none; z-index: 1000"
  >
    <form name="advFilterForm" novalidate>
      <div layout="row" layout-align="space-between center" class="ml0 mr0">
        <h4 class="text-bold mb0 pl-lg">
          {{"general.FILTER_MATCH_ALL" | translate}}
        </h4>
        <div>
          <md-button class="md-icon-button" ng-click="onAdvFilter=false">
            <md-icon
              md-svg-src="app/img/icons/ic_close_24px.svg"
              aria-label="Close dialog"
            ></md-icon>
          </md-button>
        </div>
      </div>
      <hr class="fancy mv-sm" />
      <div class="clearfix mh sec-adv-filter-content">
        <div class="row mv">
          <div class="col col-sm-3 text-muted">
            {{'securityEvent.LABELS' | translate}}:
          </div>
          <div class="col col-sm-9" style="padding-left: 48px;">
            <div class="row mb-sm ml0 mr0 pb-sm bottom-line">
              <div class="col col-sm-4">
                <input
                  type="checkbox"
                  id="check-critical"
                  name="level-filter"
                  ng-model="levelFilter.isFilteringCritical"
                />
                <label
                  class="sec-event-label sec-event-danger"
                  for="check-critical"
                  >{{'enum.CRITICAL' | translate}}</label
                >
              </div>
              <div class="col col-sm-4">
                <input
                  type="checkbox"
                  id="check-warning"
                  name="level-filter"
                  ng-model="levelFilter.isFilteringWarning"
                />
                <label
                  class="sec-event-label sec-event-warning"
                  for="check-warning"
                  >{{'enum.WARNING' | translate}}</label
                >
              </div>
              <div class="col col-sm-4">
                <input
                  type="checkbox"
                  id="check-info"
                  name="level-filter"
                  ng-model="levelFilter.isFilteringInfo"
                />
                <label class="sec-event-label sec-event-info" for="check-info"
                  >{{'enum.INFO' | translate}}</label
                >
              </div>
            </div>
            <div class="row mb-sm ml0 mr0 pb-sm bottom-line">
              <div class="col col-sm-4">
                <input
                  type="checkbox"
                  id="check-host"
                  name="unit-filter"
                  ng-model="unit.isFilteringHost"
                />
                <label class="sec-event-label sec-event-primary" for="check-host"
                  >{{'securityEvent.label.HOST' | translate}}</label
                >
              </div>
              <div class="col col-sm-4">
                <input
                  type="checkbox"
                  id="check-container"
                  name="unit-filter"
                  ng-model="unit.isFilteringContainer"
                />
                <label
                  class="sec-event-label sec-event-primary"
                  for="check-container"
                  >{{'securityEvent.label.CONTAINER' | translate}}</label
                >
              </div>
            </div>
            <div class="row mb-sm ml0 mr0 pb-sm bottom-line">
              <div class="col col-sm-4">
                <input
                  type="checkbox"
                  id="check-network"
                  name="media-filter"
                  ng-model="media.isFilteringNetwork"
                />
                <label
                  class="sec-event-label sec-event-primary"
                  for="check-network"
                  >{{'securityEvent.label.NETWORK' | translate}}</label
                >
              </div>
              <div class="col col-sm-4">
                <input
                  type="checkbox"
                  id="check-package"
                  name="media-filter"
                  ng-model="media.isFilteringPackage"
                />
                <label
                  class="sec-event-label sec-event-primary"
                  for="check-package"
                  >{{'securityEvent.label.PACKAGE' | translate}}</label
                >
              </div>
              <div class="col col-sm-4">
                <input
                  type="checkbox"
                  id="check-file"
                  name="media-filter"
                  ng-model="media.isFilteringFile"
                />
                <label class="sec-event-label sec-event-primary" for="check-file"
                  >{{'securityEvent.label.FILE' | translate}}</label
                >
              </div>
              <div class="col col-sm-4">
                <input
                  type="checkbox"
                  id="check-tunnel"
                  name="media-filter"
                  ng-model="media.isFilteringTunnel"
                />
                <label
                  class="sec-event-label sec-event-primary"
                  for="check-tunnel"
                  >{{'securityEvent.label.TUNNEL' | translate}}</label
                >
              </div>
              <div class="col col-sm-4">
                <input
                  type="checkbox"
                  id="check-process"
                  name="media-filter"
                  ng-model="media.isFilteringProcess"
                  ng-model="media.isFilteringProcess"
                />
                <label
                  class="sec-event-label sec-event-primary"
                  for="check-process"
                  >{{'securityEvent.label.PROCESS' | translate}}</label
                >
              </div>
              <div class="col col-sm-4">
                <input
                  type="checkbox"
                  id="check-privilege"
                  name="media-filter"
                  ng-model="media.isFilteringPrivilege"
                />
                <label
                  class="sec-event-label sec-event-primary"
                  for="check-privilege"
                  >{{'securityEvent.label.PRIVILEGE' | translate}}</label
                >
              </div>
            </div>
            <div class="row ml0 mr0">
              <div class="col col-sm-4">
                <input
                  type="checkbox"
                  id="check-other"
                  ng-model="others.isFilteringOther"
                />
                <label class="sec-event-label sec-event-muted" for="check-other"
                  >{{'securityEvent.label.OTHER' | translate}}</label
                >
              </div>
            </div>
          </div>
        </div>
        <hr class="mv-sm" />
        <div class="row mv">
          <div class="col col-sm-4 text-muted">
            {{'securityEvent.HOST' | translate}}:
          </div>
          <div class="col col-sm-8 pl0">
            <md-autocomplete
              class="filter-autocomplete"
              required="false"
              ng-disabled="isDisabled"
              md-no-cache="noCache"
              md-input-name="autocompleteHost"
              md-selected-item="selectedItemHost"
              md-search-text="searchTextHost"
              md-items="host in autocompleteHosts | filter: searchTextHost"
              md-item-text="host.display"
              md-search-text-change="cutStringByMaxLength(searchTextHost, 'searchTextHost')"
            >
              <md-item-template>
                <span md-highlight-text="searchTextHost">{{host.display}}</span>
              </md-item-template>
              <md-not-found>
                No matches found.
              </md-not-found>
            </md-autocomplete>
          </div>
        </div>
        <div class="row mv">
          <div class="col col-sm-4 text-muted">
            {{'securityEvent.SOURCE' | translate}}:
          </div>
          <div class="col col-sm-8 pl0">
            <md-autocomplete
              class="filter-autocomplete"
              required="false"
              ng-disabled="isDisabled"
              md-no-cache="noCache"
              md-input-name="autocompleteSource"
              md-selected-item="selectedItemSource"
              md-search-text="searchTextSource"
              md-items="source in autocompleteSources | filter: searchTextSource"
              md-item-text="source.display"
              md-search-text-change="cutStringByMaxLength(searchTextSource, 'searchTextSource')"
            >
              <md-item-template>
                <span md-highlight-text="searchTextSource"
                  >{{source.display}}</span
                >
              </md-item-template>
              <md-not-found>
                No matches found.
              </md-not-found>
            </md-autocomplete>
          </div>
        </div>
        <div class="row mv">
          <div class="col col-sm-4 text-muted">
            {{'securityEvent.DESTINATION' | translate}}:
          </div>
          <div class="col col-sm-8 pl0">
            <md-autocomplete
              class="filter-autocomplete"
              required="false"
              ng-disabled="isDisabled"
              md-no-cache="noCache"
              md-input-name="autocompleteDestination"
              md-selected-item="selectedItemDestination"
              md-search-text="searchTextDestination"
              md-items="destination in autocompleteDestinations | filter: searchTextDestination"
              md-item-text="destination.display"
              md-search-text-change="cutStringByMaxLength(searchTextDestination, 'searchTextDestination')"
            >
              <md-item-template>
                <span md-highlight-text="searchTextDestination"
                  >{{destination.display}}</span
                >
              </md-item-template>
              <md-not-found>
                No matches found.
              </md-not-found>
            </md-autocomplete>
          </div>
        </div>
        <div class="row mv">
          <div class="col col-sm-4 text-muted">
            {{'securityEvent.DOMAIN' | translate}}:
          </div>
          <div class="col col-sm-8 pl0">
            <tags-input
              id="domain"
              ng-model="selectedDomains"
              display-property="name"
              class="filter-autocomplete"
              placeholder="{{'securityEvent.DOMAIN_PLACEHOLDER' | translate}}"
              add-from-autocomplete-only="true">
              <auto-complete
                source="loadTags($query)"
                min-length="1"
                max-results-to-show="128"
                max-length="{{'general.FILTER_MAX_LEN' | translate}}">
              </auto-complete>
            </tags-input>
          </div>
        </div>
        <div class="row mv">
          <div class="col col-sm-4 text-muted">
            {{'securityEvent.OTHER_KEYWORD' | translate}}:
          </div>
          <div class="col col-sm-8 pl0">
            <input
              class="filter-text"
              ng-model="otherKey"
              maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
            />
          </div>
        </div>
        <div class="row mv">
          <div class="col col-sm-4 text-muted">
            {{'securityEvent.EXCLUDED_KEYWORD' | translate}}:
          </div>
          <div class="col col-sm-8 pl0">
            <input
              class="filter-text"
              ng-model="excludedKey"
              maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
            />
          </div>
        </div>
        <button
          ng-click="resetAdvFilter()"
          class="btn btn-wide btn-default pull-right mt-sm"
        >
          {{'enum.RESET' | translate}}
        </button>
        <button
          ng-click="onFilterChanged('adv', otherKey, excludedKey)"
          class="btn btn-wide btn-default pull-right mr-lg mt-sm"
        >
          {{'securityEvent.APPLY' | translate}}
        </button>
      </div>
    </form>
  </div>

  <!--view all files modal-->
  <div
    id="all-files"
    class="ports-panel-wrap"
    ng-show="isAllFilesShown"
    ng-style="panelPosition"
  >
    <div class="row m0">
      <div class="pull-left">
        <h4>{{'securityEvent.ALL_FILES' | translate}}:</h4>
      </div>
      <div class="pull-right">
        <em
          class="fa fa-times all-ports-close"
          aria-hidden="true"
          ng-click="hideAllFiles()"
        ></em>
      </div>
    </div>
    <div class="row m0" style="position: relative;">
      <div class="ports-panel">{{currFiles}}</div>
      <div ng-show="isGradientTopBottomShown" class="top-mask"></div>
      <div ng-show="isGradientTopBottomShown" class="bottom-mask"></div>
    </div>
  </div>

  <!--view packet modal-->
  <div
    id="packetPreview"
    class="sec-event-packetPreview pl-sm pr"
    ng-show="onPacketPreview"
    style="z-index: 110;"
  >
    <button
      class="btn btn-xs btn-link pull-right fixed-close"
      ng-click="onPacketPreview=false"
    >
      <em class="fa fa-times" />
    </button>
    <div
      class="pull-right mt-sm mr-lg fixed-download"
      ng-click="exportPcap($event)"
      ng-if="!packetErr"
    >
      <em class="fa fa-download text-action" />
      <label class="text-gray-label hand"
        >{{'general.PCAP_DOWNLOAD' | translate}}</label
      >
    </div>
    <div class="packetContent">
      <div class="view view-offset" ng-show="!packetErr">
        <b ng-repeat="pos in positions">{{pos}}</b>
      </div>
      <div class="view view-hex" ng-show="!packetErr">
        <span
          ng-repeat="hex in hexItems track by $index"
          ng-class="{current: current == $index + offset}"
          ng-click="setCurrent($index + offset)"
          >{{hex}}</span
        >
      </div>
      <div class="view view-char mr-sm" ng-show="!packetErr">
        <span
          ng-repeat="character in chars track by $index"
          ng-class="{current: current == $index + offset}"
          ng-click="setCurrent($index + offset)"
          >{{character}}</span
        >
      </div>
      <div ng-show="packetErr">
        <div class="server-error" style="margin: 0 30px;">
          <div>
            <em class="fa fa-times-circle error-signal" aria-hidden="true"></em>
          </div>
          <div><span class="error-text">{{packetErrMSG}}</span></div>
        </div>
      </div>
    </div>
  </div>

  <!--threats details content-->
  <script type="text/ng-template" id="threat-details.html">
    <hr style="margin: 5px auto;"/>
    <div class="row message-box-wrap">
      <div class="full-width-panel">
        <div class="full-width-summary">
          <span class="label" ng-class="secEvent.details.message.cssColor">{{"nodes.gridHeader.MESSAGE" | translate}}</span><br/>
        </div>
        <div class="full-width-center message-box">
          <div name="what" style="border-bottom: #bbb 1px dashed;">
            <span ng-if="secEvent.applications">
              <span class="text-bold">{{"threat.gridHeader.APPLICATION" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.applications}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.message.content">
              <span class="text-bold">{{"securityEvent.DESC" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.content}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.count">
              <span class="text-bold">{{"threat.gridHeader.COUNT" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.count}}
              </span>&nbsp;&nbsp;
            </span>
          </div>
          <div name="where">
            <span ng-if="secEvent.details.clusterName">
              <span class="text-bold">{{"violation.gridHeader.CLUSTER_NAME" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.clusterName}}
              </span>&nbsp;&nbsp;
            </span>
            <div ng-if="secEvent.enforcerName && secEvent.hostName">
              <span class="text-bold">{{"securityEvent.REPORTED_BY" | translate}}:</span>&nbsp;
              <span class="text-muted">
              <span class="link" ng-click="showEnforcerDetails($event, secEvent.enforcerId, secEvent.enforcerName)">{{secEvent.enforcerName}}</span> on <span class="link" ng-click="showHostDetails($event, secEvent.hostId, secEvent.host_name)">{{secEvent.hostName}}</span>
            </span>&nbsp;&nbsp;
            </div>
          </div>
        </div>
      </div>
    </div>
  </script>
  <!--violations details content-->
  <script type="text/ng-template" id="violation-details.html">
    <hr style="margin: 5px auto;"/>
    <div class="row message-box-wrap">
      <div class="full-width-panel">
        <div class="full-width-summary">
          <span class="label" ng-class="secEvent.details.message.cssColor">{{"nodes.gridHeader.MESSAGE" | translate}}</span><br/>
        </div>
        <div class="full-width-center message-box">
          <div name="what" style="border-bottom: #bbb 1px dashed;">
            <span ng-if="secEvent.applications">
              <span class="text-bold">{{"violation.gridHeader.APPLICATIONS" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.applications}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.serverPort">
              <span class="text-bold" ng-if="secEvent.details.port>0">{{"violation.gridHeader.SERVER_PORT" | translate}}:</span>
              <span class="text-bold" ng-if="secEvent.details.port===0">{{"violation.gridHeader.PROTOCOL" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.serverPort}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.serverImage">
              <span class="text-bold">{{"violation.gridHeader.SERVER_IMAGE" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.serverImage}}
              </span>&nbsp;&nbsp;
            </span>
          </div>
          <div name="where">
            <span ng-if="secEvent.details.clusterName">
              <span class="text-bold">{{"violation.gridHeader.CLUSTER_NAME" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.clusterName}}
              </span>&nbsp;&nbsp;
            </span>
            <div ng-if="secEvent.enforcerName && secEvent.hostName">
              <span class="text-bold">{{"securityEvent.REPORTED_BY" | translate}}:</span>&nbsp;
                <span class="text-muted">
                <span class="link" ng-click="showEnforcerDetails($event, secEvent.enforcerId, secEvent.enforcerName)">{{secEvent.enforcerName}}</span> on <span class="link" ng-click="showHostDetails($event, secEvent.hostId, secEvent.host_name)">{{secEvent.hostName}}</span>
              </span>&nbsp;&nbsp;
            </div>
          </div>
        </div>
      </div>
    </div>
  </script>

  <!--incidents details content-->
  <script type="text/ng-template" id="incident-details.html">
    <hr style="margin: 5px auto;"/>
    <div class="row message-box-wrap">
      <div class="full-width-panel">
        <div class="full-width-summary">
          <span class="label" ng-class="secEvent.details.message.cssColor">{{"nodes.gridHeader.MESSAGE" | translate}}</span><br/>
        </div>
        <div class="full-width-center message-box">
          <div ng-if="secEvent.details.message.content" style="border-bottom: #bbb 1px dashed;">
            <span>{{secEvent.details.message.content}}</span>
          </div>
          <div name="what" style="border-bottom: #bbb 1px dashed;">
            <span ng-if="secEvent.details.message.procParentName">
              <span class="text-bold">{{"securityEvent.PROC_P_NAME" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.procParentName}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.message.procParentPath">
              <span class="text-bold">{{"securityEvent.PROC_P_PATH" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.procParentPath}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.message.procName">
              <span class="text-bold">{{"securityEvent.PROC_NAME" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.procName}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.message.procPath">
              <span class="text-bold">{{"securityEvent.PROC_PATH" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.procPath}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.message.procCmd">
              <span ng-if="secEvent.name.toLowerCase().indexOf('process') >= 0 || secEvent.name.toLowerCase().indexOf('escalation') >= 0 || secEvent.name.toLowerCase().indexOf('detected') >= 0"
                class="text-bold">
                {{"securityEvent.PROC_CMD" | translate}}:
              </span>&nbsp;
              <span ng-if="secEvent.name.toLowerCase().indexOf('process') < 0 && secEvent.name.toLowerCase().indexOf('escalation') < 0 && secEvent.name.toLowerCase().indexOf('detected') < 0"
                class="text-bold">
                {{"securityEvent.CMD" | translate}}:
              </span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.procCmd}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.message.procEffectiveUid">
              <span class="text-bold">{{"securityEvent.PROC_EFF_UID" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.procEffectiveUid}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.message.procEffectiveUser">
              <span class="text-bold">{{"securityEvent.PROC_EFF_USER" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.procEffectiveUser}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.message.localIP">
              <span class="text-bold">{{"securityEvent.LOCAL_IP" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.localIP}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.message.remoteIP">
              <span class="text-bold">{{"securityEvent.REMOTE_IP" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.remoteIP}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.message.localPort">
              <span class="text-bold">{{"securityEvent.LOCAL_PORT" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.localPort}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.message.remotePort">
              <span class="text-bold">{{"securityEvent.REMOTE_PORT" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.remotePort}}
              </span>&nbsp;&nbsp;
            </span>
            <!--<span ng-if="secEvent.details.message.etherType">
              <span class="text-bold">{{"securityEvent.ETHER_TYPE" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.etherType}}
              </span>&nbsp;&nbsp;
            </span>-->
            <span ng-if="secEvent.details.message.ipProto">
              <span class="text-bold">{{"securityEvent.IP_PROTO" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.ipProto}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.message.filePath">
              <span class="text-bold">{{"securityEvent.FILE_PATH" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.filePath}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.message.fileNames">
              <span class="text-bold">{{"securityEvent.FILE_NAME" | translate}}:</span>&nbsp;
              <span class="text-muted" ng-if="secEvent.details.message.fileNames.length > 100">
                {{secEvent.details.message.fileNames.substring(0, 101)}}...
                <span class="link" ng-click="showAllFiles(secEvent.details.message.fileNames, $event)">
                  ({{"general.VIEW_ALL" | translate}})
                </span>
              </span>&nbsp;&nbsp;
              <span class="text-muted" ng-if="secEvent.details.message.fileNames.length <= 100">
                {{secEvent.details.message.fileNames}}
              </span>&nbsp;&nbsp;
            </span>
            <span id="count" ng-if="secEvent.details.message.count>1">
              <span class="text-bold">{{"securityEvent.COUNT" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.message.count}}
              </span>&nbsp;&nbsp;
            </span>
          </div>
          <div name="where">
            <span ng-if="secEvent.details.clusterName">
              <span class="text-bold">{{"violation.gridHeader.CLUSTER_NAME" | translate}}:</span>&nbsp;
              <span class="text-muted">
                {{secEvent.details.clusterName}}
              </span>&nbsp;&nbsp;
            </span>
            <span ng-if="secEvent.details.message.group">
              <span class="text-bold">{{"securityEvent.GROUP" | translate}}:</span>&nbsp;
              <span class="text-muted link hand" ui-sref="app.group({groupName: secEvent.details.message.group, from: 'process'})">
                {{secEvent.details.message.group}}
              </span>&nbsp;&nbsp;
            </span>
            <div ng-if="secEvent.enforcerName && secEvent.hostName">
              <span class="text-bold">{{"securityEvent.REPORTED_BY" | translate}}:</span>&nbsp;
              <span class="text-muted">
                <span class="link" ng-click="showEnforcerDetails($event, secEvent.enforcerId, secEvent.enforcerName)">{{secEvent.enforcerName}}</span> on <span class="link" ng-click="showHostDetails($event, secEvent.hostId, secEvent.host_name)">{{secEvent.hostName}}</span>
              </span>&nbsp;&nbsp;
            </div>
          </div>
        </div>
      </div>
    </div>
  </script>

  <!--review process rule modal-->
  <script type="text/ng-template" id="dialog.review-process-rule.html">
    <md-dialog aria-label="Review Process Profile Rule" class="dialog-lg" style="overflow: visible">
      <form name="ReviewProcessRuleForm" ng-submit="$event.preventDefault()" novalidate="" class="form-validate" style="overflow: visible">
        <md-toolbar>
          <div class="md-toolbar-tools">
            <h2 class="text-dark">{{'securityEvent.REVIEW_RULE' | translate}}</h2>
            <span flex></span>
            <md-button class="md-icon-button" ng-click="cancel()">
              <md-icon md-svg-src="app/img/icons/ic_close_24px.svg" aria-label="Close dialog"></md-icon>
            </md-button>
          </div>
        </md-toolbar>
        <md-dialog-content style="overflow: visible" ng-class="{'mb-lg': !isEditable}">
          <div class="card-body">
            <div class="mh-lg">
              <h5 ng-show="isReadOnlyRule">{{'securityEvent.PROC_RULE' | translate}}</h5>
              <h5 ng-show="!isReadOnlyRule">
                {{'securityEvent.PROPOSED_RULE' | translate}}
                <span class="label label-success-tran" style="display: inline; font-size: 12px;"
                      translate="{{'policy.head.NEW_RULE'}}">
                </span>
              </h5>
            </div>
            <div>
              <form name="ruleForm" novalidate="">
                <div class="col-sm-4">
                  <md-input-container class="md-block mb0">
                    <label>{{'securityEvent.GROUP' | translate}}</label>
                    <input disabled ng-model="secEvent.details.message.group"/>
                  </md-input-container>
                </div>
                <div class="col-sm-4">
                  <md-input-container class="md-block mb0">
                    <label>{{'service.gridHeader.NAME' | translate}}</label>
                    <input disabled ng-model="secEvent.details.message.procName"/>
                  </md-input-container>
                </div>
                <div class="col-sm-4">
                  <md-input-container class="md-block mb0">
                    <label>{{'service.gridHeader.PATH' | translate}}</label>
                    <input disabled ng-model="secEvent.details.message.procPath"/>
                  </md-input-container>
                </div>
                <div class="col-sm-2 mb0" style="margin-top: 25px;" ng-if="isReadOnlyRule && processRule.cfg_type">
                  <div ng-if="processRule.cfg_type === CFG_TYPE.LEARNED" class="label learn-rule"
                       translate="{{'group.LEARNED'}}">
                  </div>
                  <div ng-if="processRule.cfg_type === CFG_TYPE.CUSTOMER" class="label customer-rule"
                       translate="{{'group.CUSTOM'}}">
                  </div>
                  <div ng-if="processRule.cfg_type === CFG_TYPE.GROUND" class="label ground-rule"
                       translate="{{'group.GROUND'}}">
                  </div>
                  <div ng-if="processRule.cfg_type === CFG_TYPE.FED" class="label fed-rule"
                       translate="{{'group.FED'}}">
                  </div>
                </div>
                <div class="col-sm-2 mb0">
                  <label class="text-muted">{{'policy.editPolicy.DENY_ALLOW' | translate}}</label>
                  <div>
                    <nz-toggle class="mt0"
                               width="50"
                               color-false="'#ff8a65'"
                               color-true="'#81c784'"
                               ng-model="newAction"
                               ng-disabled="true"
                               val-true="true"
                               val-false="false">
                    </nz-toggle>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </md-dialog-content>
        <div class="md-actions" layout="row" style="border: 0;" ng-if="!isReadOnlyRule && isUpdateRuleAuthorized">
          <div class="proposed-rule-warning pull-left mr" style="width: 100%;">{{'securityEvent.NEW_RULE_WARNING' | translate}}</div>
          <md-button class="md-raised md-primary"
                     ng-click="updateProcessRule()">
            <em class="fa fa-save mr-sm"/>{{'policy.portlet.SUBMIT' | translate}}
          </md-button>
          <a ng-click="cancel()" class="nv-link">
            {{'group.editGroup.CANCEL' | translate}}
          </a>
        </div>
      </form>
    </md-dialog>
  </script>

  <!--review file rule modal-->

  <!--review network rule modal-->
  <script type="text/ng-template" id="dialog.review-network-rule.html">
    <md-dialog aria-label="Review Network Rule" class="dialog-lg" style="overflow: visible">
      <div name="groupForm" class="form-validate" style="overflow: visible">
        <md-toolbar>
          <div class="md-toolbar-tools">
            <h2 class="text-dark">{{'securityEvent.REVIEW_RULE' | translate}}</h2>
            <span flex></span>
            <md-button class="md-icon-button" ng-click="cancel()">
              <md-icon md-svg-src="app/img/icons/ic_close_24px.svg" aria-label="Close dialog"></md-icon>
            </md-button>
          </div>
        </md-toolbar>
        <md-dialog-content style="overflow: visible" ng-class="{'mb-lg': !isEditable}" class="clearfix">
          <div class="card-body" ng-if="isReadOnlyRule">
            <div class="mh-lg">
              <h5>{{'securityEvent.NETWORK_RULE' | translate}}
                <span class="label {{ruleTypeClass}}" style="display: inline; font-size: 12px;">
                  {{networkRule.id}}
                </span>
              </h5>
            </div>
            <div>
              <div>
                <div class="col-sm-6">
                  <md-input-container class="md-block mb0">
                    <label>{{'policy.editPolicy.FROM' | translate}}</label>
                    <input disabled ng-model="networkRule.from"/>
                  </md-input-container>
                </div>
                <div class="col-sm-6">
                  <md-input-container class="md-block mb0">
                    <label>{{'policy.editPolicy.TO' | translate}}</label>
                    <input disabled ng-model="networkRule.to"/>
                  </md-input-container>
                </div>
                <div class="col-sm-6 mb0">
                  <md-input-container class="md-block mb0">
                    <label>{{'policy.addPolicy.APP' | translate}}</label>
                    <input disabled value="{{networkRule.applications.join(', ')}}"/>
                  </md-input-container>
                </div>
                <div class="col-sm-6 mb0">
                  <md-input-container class="md-block mb0">
                    <label>{{'policy.editPolicy.PORT' | translate}}</label>
                    <input disabled value="{{networkRule.ports}}"/>
                  </md-input-container>
                </div>
                <div class="col-sm-6 mb0" ng-if="networkRule.last_modified_timestamp">
                  <md-input-container class="md-block">
                    <label>{{'policy.gridHeader.UPDATE_AT' | translate}}</label>
                    <input disabled
                           value="{{networkRule.last_modified_timestamp * 1000 | date:'MMM dd, y HH:mm:ss'}}"/>
                  </md-input-container>
                </div>
                <div class="col-sm-6 mb0">
                  <label class="text-muted">{{'policy.editPolicy.DENY_ALLOW' | translate}}</label>
                  <div>
                    <nz-toggle class="mt0"
                               width="50"
                               color-false="'#ff9800'"
                               color-true="'#81c784'"
                               ng-model="networkRule.allowed"
                               ng-disabled="true"
                               val-true="true"
                               val-false="false">
                    </nz-toggle>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card-body" ng-if="!isReadOnlyRule">
            <div>
              <div class="mh-lg clearfix" ng-if="networkRule.id">
                <h5>
                  {{'securityEvent.VIOLATED_RULE' | translate}}
                  <span class="label {{ruleTypeClass}} mr-sm" style="display: inline; font-size: 12px;">
                    {{networkRule.id}}
                  </span>
                </h5>
                <div class="col-sm-12 pl-sm pr-sm text-muted" style="font-size: 14px;">
                    {{violatedRule}}
                </div>
              </div>
              <div class="mh-lg clearfix" ng-if="!networkRule.id">
                <h5>
                  {{'securityEvent.VIOLATED_RULE' | translate}}
                  <span class="label label-caution mr-sm" style="display: inline; font-size: 12px;">
                    Implicit
                  </span>
                </h5>
                <div class="col-sm-12 pl-sm pr-sm text-muted" style="font-size: 14px;">
                  {{violatedImplicitRule}}
                </div>
              </div>
              <hr class="dashed mv-sm"/>
              <div class="mh-lg clearfix">
                <h5>
                  {{'securityEvent.PROPOSED_RULE' | translate}}
                  <span class="label label-success-tran" style="display: inline; font-size: 12px;"
                        translate="{{'policy.head.NEW_RULE'}}">
                  </span>
                </h5>
              </div>
              <div class="clearfix">
                <form name="ruleForm" novalidate="">
                  <div class="col-sm-6">
                    <md-input-container class="md-block mb0">
                      <label>{{'policy.editPolicy.FROM' | translate}}</label>
                      <input disabled ng-model="networkRule.from"/>
                    </md-input-container>
                  </div>
                  <div class="col-sm-6">
                    <md-input-container class="md-block mb0">
                      <label>{{'policy.editPolicy.TO' | translate}}</label>
                      <input disabled ng-model="networkRule.to"/>
                    </md-input-container>
                  </div>
                  <div class="col-sm-6 mb0">
                    <md-input-container class="md-block mb0">
                      <label>{{'policy.addPolicy.APP' | translate}}</label>
                      <input disabled ng-style="{'background-color': secEvent.applications === networkRule.applications.join(', ') ? 'none' : '#fff7f0'}" value="{{secEvent.applications}}"/>
                    </md-input-container>
                  </div>
                  <div class="col-sm-6 mb0">
                    <md-input-container class="md-block mb0">
                      <label >{{'policy.editPolicy.PORT' | translate}}</label>
                      <input disabled ng-style="{'background-color': comparePortStr(secEvent.details.serverPort, networkRule.ports) ? 'none' : '#fff7f0'}" value="{{secEvent.details.serverPort}}"/>
                    </md-input-container>
                  </div>
                  <div class="col-sm-4 mb0">
                    <label class="text-muted">{{'policy.editPolicy.DENY_ALLOW' | translate}}</label>
                    <div>
                      <nz-toggle class="mt0"
                                 width="50"
                                 color-false="'#ff9800'"
                                 color-true="'#81c784'"
                                 ng-model="newAction"
                                 ng-disabled="true"
                                 val-true="true"
                                 val-false="false">
                      </nz-toggle>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </md-dialog-content>
        <div class="md-actions" layout="row" style="border: 0;" ng-if="!isReadOnlyRule && isUpdateRuleAuthorized">
          <div class="proposed-rule-warning pull-left mr" style="width: 100%;">{{'securityEvent.NEW_RULE_WARNING' | translate}}</div>
          <md-button class="md-raised md-primary"
                  ng-click="updateNetworkRule()">
            <em class="fa fa-save mr-sm"/>{{'policy.portlet.SUBMIT' | translate}}
          </md-button>
          <a ng-click="cancel()" class="nv-link">
            {{'group.editGroup.CANCEL' | translate}}
          </a>
        </div>
      </div>
    </md-dialog>
  </script>

  <!--container details modal-->
  <div
    id="endpoint-details"
    class="sec-endpoint-details pb0"
    ng-show="onContainerDetail"
    style="z-index: 110;"
  >
    <div class="sec-endpoint-details-header">
      <div class="pull-left mt-sm ml">
        <strong>{{containerTitle}}</strong>
        <span ng-if="workload.state === 'exit'" class="label label-idle" style="display: inline;">
          {{'enforcers.detail.DISCONNECTED_AT' | translate}}: {{workload.finished_at | date:'MMM dd, y HH:mm:ss'}}
        </span>
      </div>
      <button
        class="btn btn-xs btn-link pull-right mt-sm"
        ng-click="onContainerDetail=false"
      >
        <em class="fa fa-times text-muted" />
      </button>
    </div>
    <div class="sec-endpoint-details-content">
      <div class="mb">
        <div class="row ml0 mr0">
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'controllers.detail.ID' | translate}}</div>
              <div class="icon">
                <em class="fa fa-credit-card text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{workload.id}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{workload.id}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'containers.detail.HOST_NAME' | translate}}</div>
              <div class="icon">
                <em class="fa fa-server text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{workload.host_name}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{workload.host_name}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'scan.gridHeader.DOMAIN' | translate}}</div>
              <div class="icon">
                <em class="fa fa-building-o text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{workload.domain}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{workload.domain}}
              </div>
            </div>
          </div>
        </div>
        <div class="row ml0 mr0">
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'containers.detail.ENFORCER' | translate}}</div>
              <div class="icon">
                <em class="fa fa-shield text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{workload.enforcer_id}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{workload.enforcer_id}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'containers.detail.APPLICATIONS' | translate}}</div>
              <div class="icon">
                <em class="fa fa-cubes text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{workload.applications.join(', ')}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{workload.applications.join(', ')}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'containers.detail.NETWORK_MODE' | translate}}</div>
              <div class="icon">
                <em class="fa fa-globe text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{workload.network_mode}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{workload.network_mode}}
              </div>
            </div>
          </div>
        </div>
        <div class="row ml0 mr0">
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'containers.detail.IMAGE' | translate}}</div>
              <div class="icon">
                <em class="fa fa-archive text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{workload.image}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{workload.image}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'containers.detail.SERVICE_GROUP' | translate}}</div>
              <div class="icon">
                <em class="fa fa-th-large text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{workload.service_group}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{workload.service_group}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'containers.detail.ROOT_PRIVILEGED' | translate}}</div>
              <div class="icon">
                <em
                  class="text-primary fa-lg"
                  ng-class="workload.privileged ? 'icon-user-unfollow' : 'icon-user-following'"
                />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{workload.privileged}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{workload.privileged}}
              </div>
            </div>
          </div>
        </div>
        <div class="row ml0 mr0">
          <div class="col-md-4" ng-if="workload.policy_mode">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'containers.detail.POLICY_MODE' | translate}}</div>
              <div class="icon">
                <em
                  class="fa text-primary fa-lg"
                  ng-class="{'fa-binoculars': workload.policy_mode.toLowerCase()==='discover', 'fa-bell': workload.policy_mode.toLowerCase()==='monitor', 'fa-shield': workload.policy_mode.toLowerCase()==='protect'}"
                />
              </div>
              <!--<div>
                <span style="width: 90px; height: 25x; line-height: 20px;" class="label label-fs" ng-class="{'label-discover': workload.policy_mode.toLowerCase()==='discover', 'label-monitor': workload.policy_mode.toLowerCase()==='monitor', 'label-protect': workload.policy_mode.toLowerCase()==='protect'}">
                  {{workload.policy_mode_txt}}
                </span>
              </div>-->
              <div class="pull-left">
                <div uib-dropdown dropdown-append-to-body class="mt-sm pull-left">
                  <div uib-dropdown-toggle class="pull-left pl0">
                    <div ng-bind-html="modeHtml" class="pull-left pl0"></div>
                  </div>
                  <ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="single-button">
                    <li role="menuitem" ng-hide="workload.policy_mode === 'Discover'">
                      <a type="button" ng-click="switchServiceModeOnPopup('Discover', workload)">
                        <em class="fa fa-binoculars fa-fw text-discover mr-sm"></em>{{'enum.DISCOVER' | translate}}
                      </a>
                    </li>
                    <li role="menuitem" ng-hide="workload.policy_mode === 'Monitor'">
                      <a type="button" ng-click="switchServiceModeOnPopup('Monitor', workload)">
                        <em class="fa fa-bell fa-fw text-monitor mr-sm"></em>{{'enum.MONITOR' | translate}}
                      </a>
                    </li>
                    <li class="menuitem" ng-hide="workload.policy_mode === 'Protect'">
                      <a type="button" ng-click="switchServiceModeOnPopup('Protect', workload)">
                        <em class="fa fa-shield fa-fw text-protect mr-sm"></em>{{'enum.PROTECT' | translate}}
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'group.gridHeader.VULNERABILITIES' | translate}}</div>
              <div class="icon">
                <em class="fa fa-bug text-warning fa-lg"></em>
              </div>
              <div>
                <label
                  class="label label-danger mr-sm"
                >
                  {{workload.scan_summary.high}}</label
                >
                <label
                  class="label label-warning"
                >
                  {{workload.scan_summary.medium}}</label
                >
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'scan.gridHeader.TIME' | translate}}</div>
              <div class="icon">
                <em class="fa fa-calendar text-primary fa-lg" />
              </div>
              <div class="text-muted">
                {{workload.scan_summary.scanned_at | date:'MMM dd, y HH:mm:ss'}}
              </div>
            </div>
          </div>
        </div>
        <div ng-if="workload.state === 'exit'" class="row ml0 mr0">
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'enforcers.detail.DISCONNECTED_AT' | translate}}</div>
              <div class="icon">
                <em class="fa fa-calendar text-inverse fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{workload.finished_at | date:'MMM dd, y HH:mm:ss'}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{workload.finished_at | date:'MMM dd, y HH:mm:ss'}}
              </div>
            </div>
          </div>
        </div>
      </div>
      <uib-accordion close-others="true" class="sec-endpoint-details-collipse">
        <div
          uib-accordion-group="uib-accordion-group"
          is-open="isAccOpen2"
        >
          <uib-accordion-heading>
            <small>
              <em class="fa fa-plus text-primary mr"></em>
            </small>
            <span class="text-primary">{{'containers.detail.NETWORK_INTERFACES' | translate}}</span>
          </uib-accordion-heading>
          <div style="width: 100%; max-height: 150px; overflow-y: scroll">
            <div class="row m0" ng-repeat="(name, nets) in workload.interfaces">
              <div class="col-sm-2 text-right" ng-class-even="'bg-gray'">
                {{name}}
              </div>
              <div class="col-sm-1"></div>
              <div class="col-sm-9" ng-class-even="'bg-gray'">
                <div ng-repeat="net in nets" class="text-muted">
                  <div class="col-sm-4">
                    IP:{{net.ip}}/{{net.ip_prefix}}
                  </div>
                  <div class="col-sm-8">
                    {{"general.GATEWAY" | translate}}:{{net.gateway}}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div
          ng-if="workload.ports.length > 0"
          uib-accordion-group="uib-accordion-group"
          is-open="isAccOpen3"
        >
          <uib-accordion-heading>
            <small>
              <em class="fa fa-plus text-primary mr"></em>
            </small>
            <span class="text-primary">{{'containers.detail.PORT_MAPPING' | translate}}</span>
          </uib-accordion-heading>
          <div class="list-details" style="width: 100%; max-height: 150px; overflow-y: scroll">
            <div
              class="row m0"
              ng-repeat="mapping in workload.ports"
              ng-class-even="'bg-gray-lighter-1'"
            >
              <div class="col-sm-2 text-right">
                {{mapping.host_ip}}/{{mapping.host_port}}
              </div>
              <div class="col-sm-1 text-center">
                <em class="fa fa-long-arrow-right text-primary fa-lg" />
              </div>
              <div class="col-sm-9 text-muted">
                {{mapping.ip_proto === 6 ? 'TCP' : 'UDP'}}/{{mapping.port}}
              </div>
            </div>
          </div>
        </div>
        <div
          uib-accordion-group="uib-accordion-group"
          is-open="isAccOpen4"
        >
          <uib-accordion-heading>
            <small>
              <em class="fa fa-plus text-primary mr"></em>
            </small>
            <span class="text-primary">{{'containers.detail.LABELS' | translate}}</span>
          </uib-accordion-heading>
          <div class="list-details" style="width: 100%; max-height: 150px; overflow-y: scroll">
            <div
              class="table-row"
              ng-repeat="(label, value) in workload.labels"
            >
              <div class="row m0" ng-class-even="'bg-gray-lighter-1'">
                <div
                  class="col-sm-4 text-right auto-hide"
                  uib-tooltip="{{label}}"
                  tooltip-enable="false"
                  show-tooltip-on-text-overflow
                >
                  {{label}}
                </div>
                <div class="col-sm-8 text-muted">
                  {{value || "&nbsp;"}}
                </div>
              </div>
            </div>
          </div>
        </div>
        <div
          uib-accordion-group="uib-accordion-group"
          is-open="isAccOpen5"
        >
          <uib-accordion-heading>
            <div ng-click="fitGrid()">
              <small>
                <em class="fa fa-plus text-primary mr"></em>
              </small>
              <span class="text-primary">{{'containers.process.TAB_TITLE' | translate}}</span>
            </div>
          </uib-accordion-heading>
          <div
            id="process-details"
            ag-grid="procGridOptions"
            class="panel-body ag-grid p0"
            style="width: 100%; height: 150px;"
          ></div>
        </div>
      </uib-accordion>
    </div>
  </div>

  <!--host details modal-->
  <div
    id="host-details"
    class="sec-endpoint-details pb0"
    ng-show="onHostDetail"
    style="z-index: 110;"
  >
    <div class="sec-endpoint-details-header">
      <div class="pull-left mt-sm ml"><strong>{{host.name}}</strong></div>
      <button
        class="btn btn-xs btn-link pull-right mt-sm"
        ng-click="onHostDetail=false"
      >
        <em class="fa fa-times text-muted" />
      </button>
    </div>
    <div class="sec-endpoint-details-content">
      <div class="mb">
        <div class="row ml0 mr0">
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'nodes.detail.OS' | translate}}</div>
              <div class="icon">
                <em class="fa fa-linux text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{host.os}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{host.os}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'nodes.detail.KERNEL_VERSION' | translate}}</div>
              <div class="icon">
                <em class="fa fa-tag text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{host.kernel}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{host.kernel}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'nodes.detail.MEMORY' | translate}}</div>
              <div class="icon">
                <em class="fa fa-microchip text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{host.memory | bytes}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{host.memory | bytes}}
              </div>
            </div>
          </div>
        </div>
        <div class="row ml0 mr0">
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'nodes.detail.NUM_OF_CPUS' | translate}}</div>
              <div class="icon">
                <em class="fa fa-microchip text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{host.cpus}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{host.cpus}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'nodes.detail.NUM_OF_CONTAINERS' | translate}}</div>
              <div class="icon">
                <em class="fa fa-cubes text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{host.containers}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{host.containers}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{host.runtime | capitalize}} {{'nodes.detail.VERSION' | translate}}</div>
              <div class="icon">
                <em class="fa fa-tag text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{host.runtime_version}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{host.runtime_version}}
              </div>
            </div>
          </div>
        </div>
        <div class="row ml0 mr0">
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{host.runtime | capitalize}} {{'nodes.detail.API_VERSION' | translate}}</div>
              <div class="icon">
                <em class="fa fa-tag text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{host.runtime_api_version}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{host.runtime_api_version}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'scan.gridHeader.TIME' | translate}}</div>
              <div class="icon">
                <em class="fa fa-calendar text-primary fa-lg" />
              </div>
              <div class="text-muted">
                {{host.scan_summary.scanned_at | date:'MMM dd, y HH:mm:ss'}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'group.gridHeader.VULNERABILITIES' | translate}}</div>
              <div class="icon">
                <em class="fa fa-bug text-warning fa-lg"></em>
              </div>
              <div>
                <label
                  class="label label-danger mr-sm"
                >
                  {{host.scan_summary.high}}</label
                >
                <label
                  class="label label-warning"
                >
                  {{host.scan_summary.medium}}</label
                >
              </div>
            </div>
          </div>
        </div>
      </div>
      <uib-accordion close-others="true" class="sec-endpoint-details-collipse">
        <div
          uib-accordion-group="uib-accordion-group"
          is-open="isAccOpen2"
        >
          <uib-accordion-heading>
            <small>
              <em class="fa fa-plus text-primary mr"></em>
            </small>
            <span class="text-primary">{{'containers.detail.NETWORK_INTERFACES' | translate}}</span>
          </uib-accordion-heading>
          <div class="row" ng-repeat="(name, nets) in host.interfaces">
            <div class="col-sm-2 text-right" ng-class-even="'bg-gray'">
              {{name}}
            </div>
            <div class="col-sm-1"></div>
            <div class="col-sm-9" ng-class-even="'bg-gray'">
              <div ng-repeat="net in nets" class="text-muted">
                <div class="col-sm-4">
                  IP:{{net.ip}}/{{net.ip_prefix}}
                </div>
                <div class="col-sm-8">
                  {{"general.GATEWAY" | translate}}:{{net.gateway}}
                </div>
              </div>
            </div>
          </div>
        </div>
      </uib-accordion>
    </div>
  </div>

  <!--enforcer details modal-->
  <div
    id="enforcer-details"
    class="sec-endpoint-details pb0"
    ng-show="onEnforcerDetail"
    style="z-index: 110;"
  >
    <div class="sec-endpoint-details-header">
      <div class="pull-left mt-sm ml"><strong>{{enforcer.display_name}}</strong></div>
      <button
        class="btn btn-xs btn-link pull-right mt-sm"
        ng-click="onEnforcerDetail=false"
      >
        <em class="fa fa-times text-muted" />
      </button>
    </div>
    <div class="sec-endpoint-details-content">
      <div class="mb">
        <div class="row ml0 mr0">
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'controllers.detail.ID' | translate}}</div>
              <div class="icon">
                <em class="fa fa-credit-card text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{enforcer.id}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{enforcer.id}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'containers.detail.HOST_NAME' | translate}}</div>
              <div class="icon">
                <em class="fa fa-server text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{enforcer.host_name}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{enforcer.host_name}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'scan.gridHeader.DOMAIN' | translate}}</div>
              <div class="icon">
                <em class="fa fa-building-o text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{enforcer.domain}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{enforcer.domain}}
              </div>
            </div>
          </div>
        </div>
        <div class="row ml0 mr0">
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'enforcers.detail.VERSION' | translate}}</div>
              <div class="icon">
                <em class="fa fa-tag text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{enforcer.version}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{enforcer.version}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'enforcers.detail.CLUSTER_IP' | translate}}</div>
              <div class="icon">
                <em class="fa fa-wifi text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{enforcer.cluster_ip}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{enforcer.cluster_ip}}
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="nv-resources-detail sec-event-container-detail">
              <div>{{'controllers.detail.DURATION' | translate}}</div>
              <div class="icon">
                <em class="fa fa-calendar text-primary fa-lg" />
              </div>
              <div class="auto-hide text-muted" uib-tooltip="{{upTime}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                {{upTime}}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
