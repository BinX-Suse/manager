<div ng-controller="NodeChartController">
  <div class="clearfix">
    <div>
      <div class="pull-right mt-sm" ng-click="refresh()">
        <em class="fa fa-refresh text-action mr-sm"></em>
        <label class="text-gray-label hand">{{'general.REFRESH' | translate}}</label>
      </div>
      <div class="pull-right mr-lg" style="position: relative">
        <div uib-dropdown auto-close="outsideClick" class="mt-sm">
          <div uib-dropdown-toggle>
            <div>
              <em class="fa fa-gear fa-lg text-action mr-sm"></em>
              <label class="text-gray-label hand">{{'network.SETTING' | translate}}</label>
              <em class="fa fa-caret-down text-action" ng-click="toggleCollapse()"></em>
            </div>
          </div>
          <ul
            class="dropdown-menu" uib-dropdown-menu style="position: absolute; top: 30px;"
            role="menu" aria-labelledby="single-button"
          >
            <li role="menuitem">
              <md-checkbox
                class="md-primary mh-lg mt-lg"
                ng-checked="showSystemNode" ng-disabled="!hasSystemNodes"
                ng-click="showSystemNode = !showSystemNode; toggleSystemNode(showSystemNode)"
              >
                <label ng-class="hasSystemNodes ? 'text-gray-label' : 'text-muted-label'">{{'network.SHOW_SYS_NODE'
                | translate}}
                </label>
              </md-checkbox>
            </li>
            <li role="menuitem">
              <md-checkbox
                value="system" aria-label="system" class="md-primary mh-lg mb-sm"
                ng-model="showSystemApp" ng-change="filterApplication()"
              >
                <label class="text-gray-label">
                  {{'network.protocolFilter.SYSTEM' | translate}}
                </label>
              </md-checkbox>
            </li>
            <li class="divider"></li>
            <li class="menuitem">
              <md-checkbox
                class="md-primary mh-lg"
                ng-checked="showLegend"
                ng-click="showLegend = !showLegend"
              >
                <label class="text-gray-label">{{'network.legend.TOGGLE' | translate}}
                </label>
              </md-checkbox>
            </li>
          </ul>
        </div>
      </div>
      <div class="pull-right mr-lg">
        <div uib-dropdown class="mt-sm" style="position: relative">
          <div uib-dropdown-toggle>
            <div>
              <em class="fa fa-filter fa-lg text-action mr-sm"></em>
              <label class="text-gray-label hand">{{protocolFilterName | uppercase}}</label>
              <em class="fa fa-caret-down text-action" ng-click="toggleCollapse()"></em>
            </div>
          </div>
          <ul
            class="dropdown-menu" uib-dropdown-menu style="position: absolute; top: 30px;"
            role="menu" aria-labelledby="single-button"
          >
            <li role="menuitem" ng-repeat="protocol in protocols">
              <a ng-click="filterProtocol(protocol.id)">{{protocol.name}}</a>
            </li>
            <li class="divider"></li>
            <li role="menuitem">
              <a ng-click="filterProtocol('risks')">{{'network.protocolFilter.RISK' |
              translate}}</a>
            </li>
          </ul>
        </div>
      </div>
      <div class="pull-right mr-lg col-sm-5" style="position: relative; top: -5px">
        <tags-input
          ng-model="groupSelected"
          placeholder="{{'network.groupFilter.TITLE' | translate}}"
          display-property="name" class="nv-input-text"
          max-length="{{'general.FILTER_MAX_LEN' | translate}}"
          template="customTemplate.html"
          add-from-autocomplete-only="true"
          on-tag-added="onTagUpdate()"
          on-tag-removed="onTagUpdate()"
          max-tags="3"
          min-length="2"
        >
          <auto-complete
            source="loadGroupOrDomains($query)"
            min-length="0"
            max-results-to-show="40"
            template="autocomplete-template"
          ></auto-complete>
        </tags-input>
        <em
          class="fa fa-lg fa-check text-info"
          style="position: absolute;z-index: 999; top: 5px; right: 10px;
              padding-top: 8px;padding-left: 10px;padding-right: 10px;"
          ng-show="tagsUpdated"
          ng-click="filterOnGroup(groupSelected)"
        ></em>
      </div>

      <div class="pull-right mr-lg" ng-show="selectedNodeId" style="position: relative">
        <div uib-dropdown class="mt-sm">
          <div uib-dropdown-toggle>
            <div>
              <em class="fa fa-tasks fa-lg text-action mr-sm"></em>
              <label class="text-gray-label">{{'network.ACTIONS' | translate}}</label>
              <em class="fa fa-caret-down text-action" ng-click="toggleCollapse()"></em>
            </div>
          </div>
          <ul
            class="dropdown-menu" uib-dropdown-menu style="position: absolute; top: 30px;"
            role="menu" aria-labelledby="single-button"
          >
            <li
              role="menuitem"
              ng-class="{'disabled': !onContext.unmanagedNode || !isWriteNetworkAuthorized}"
            >
              <a
                ng-click="onAlias = true; onPopup = false"
                ng-class="{'disabledMenu': !onContext.unmanagedNode || !isWriteNetworkAuthorized}"
              >
                <em class="fa fa-tag fa-fw mr-sm"></em>{{'network.popup.ALIAS' | translate}}</a>
            </li>
            <li
              role="menuitem"
              ng-class="{'disabled': !onContext.container || (onContext.container && onContext.container.group === 'containerUnmanaged') }"
            >
              <a
                ng-click="showSessions(selectedNodeId)"
                ng-class="{'disabledMenu': !onContext.container || (onContext.container && onContext.container.group === 'containerUnmanaged') }"
              >
                <em class="fa fa-list-alt fa-fw mr-sm"></em>{{'network.nodeDetails.ACTIVE_SESSIONS'
              | translate}}</a></li>
            <li
              role="menuitem"
              ng-class="{'disabled': !(onContext.container && onContext.container.cap_sniff)}"
            >
              <a
                ng-click="showSniffer(selectedNodeId)"
                ng-class="{'disabledMenu': !(onContext.container && onContext.container.cap_sniff)}"
              >
                <em class="fa fa-video-camera fa-fw mr-sm"></em>{{'network.nodeDetails.SNIFF' |
              translate}}</a></li>
            <li
              role="menuitem"
              ng-class="{'disabled': !(onContext.container && onContext.container.cap_quarantine) || !isQuarantineAuthorized}"
              ng-if="onContext.container.state !== 'quarantined'"
            >
              <a
                ng-click="quarantine(selectedNodeId, true)"
                ng-class="{'disabledMenu': !(onContext.container && onContext.container.cap_quarantine) || !isQuarantineAuthorized}"
              >
                <em
                  class="fa fa-ban fa-fw mr-sm"
                  ng-class="{'text-muted': !(onContext.container && onContext.container.cap_quarantine) || !isQuarantineAuthorized,
                               'text-pink': onContext.container && onContext.container.cap_quarantine && isQuarantineAuthorized}"
                ></em>
                {{'network.nodeDetails.QUARANTINE' | translate}}</a></li>
            <li
              role="menuitem"
              ng-if="onContext.container && onContext.container.state === 'quarantined' && isQuarantineAuthorized"
            >
              <a ng-click="quarantine(selectedNodeId, false)">
                <em class="fa fa-ban fa-fw mr-sm"></em>
                {{'network.nodeDetails.UN_QUARANTINE' | translate}}
              </a></li>
            <li class="divider"/>
            <li
              role="menuitem"
              ng-class="{'disabled': (!onContext.domain && !onContext.group)}"
            >
              <a
                ng-click="onPopup = false; expand(onContext)"
                ng-class="{'disabledMenu': (!onContext.domain && !onContext.group)}"
              >
                <em class="fa fa-expand fa-fw mr-sm"></em>{{'network.popup.EXPAND' | translate}}</a>
            </li>
            <li
              role="menuitem"
              ng-class="{'disabled': (!onContext.domain && !onContext.group)}"
            >
              <a
                ng-click="onPopup = false; focus(onContext)"
                ng-class="{'disabledMenu': (!onContext.domain && !onContext.group)}"
              >
                <em class="fa fa-dot-circle-o fa-fw mr-sm"></em>{{'network.popup.FOCUS' |
              translate}}</a>
            </li>
            <li
              role="menuitem"
              ng-class="{'disabled': onContext.domain}"
            >
              <a
                ng-click="onPopup = false; collapseDomain(onContext)"
                ng-class="{'disabledMenu': onContext.domain}"
              >
                <em class="fa fa-compress fa-fw mr-sm"></em>{{'network.popup.COLLAPSE_DOMAIN' |
              translate}}</a>
            </li>
            <li
              role="menuitem"
              ng-class="{'disabled': onContext.domain || groupSelected || groupOnFilter || domainOnFilter}"
            >
              <a
                ng-click="onPopup = false; collapseAllDomains()"
                ng-class="{'disabledMenu': onContext.domain || groupSelected || groupOnFilter || domainOnFilter}"
              >
                <em class="fa fa-compress fa-fw mr-sm"></em>{{'network.popup.COLLAPSE_ALL_DOMAINS' |
              translate}}</a>
            </li>
            <li
              role="menuitem"
              ng-class="{'disabled': onContext.domain || onContext.group || onContext.ipGroup}"
            >
              <a
                ng-click="onPopup = false; collapseGroup(onContext)"
                ng-class="{'disabledMenu': onContext.domain || onContext.group || onContext.ipGroup}"
              >
                <em class="fa fa-compress fa-fw mr-sm"></em>{{'network.popup.COLLAPSE_GROUP' |
              translate}}</a>
            </li>
            <li
              role="menuitem"
              ng-class="{'disabled': onContext.domain || onContext.group || onContext.ipGroup || groupSelected || groupOnFilter || domainOnFilter}"
            >
              <a
                ng-click="onPopup = false; collapseAllGroups()"
                ng-class="{'disabledMenu': onContext.domain || onContext.group || onContext.ipGroup || groupSelected || groupOnFilter || domainOnFilter}"
              >
                <em class="fa fa-compress fa-fw mr-sm"></em>{{'network.popup.COLLAPSE_ALL_GROUPS' |
              translate}}</a>
            </li>
            <li class="divider"/>
            <li
              role="menuitem" ng-show="!onContext.domain"
              ng-class="{'disabled': !cap_change_mode || !policy_mode
                || policy_mode === 'Discover' || !isWriteNetworkAuthorized
                || (onContext.container && onContext.container.group === 'containerUnmanaged')}"
            >
              <a
                ng-click="switchServiceMode('Discover', currentGroup)"
                ng-class="{'disabledMenu': !cap_change_mode || !policy_mode
                || policy_mode === 'Discover' || !isWriteNetworkAuthorized
                || (onContext.container && onContext.container.group === 'containerUnmanaged')}"
              >
                <em
                  class="fa fa-binoculars fa-fw mr-sm"
                  ng-class="{'text-muted': !cap_change_mode || !policy_mode
                                             || policy_mode === 'Discover' || !isWriteNetworkAuthorized
                                             || (onContext.container && onContext.container.group === 'containerUnmanaged'),
                               'text-discover': cap_change_mode && policy_mode
                                                && policy_mode !== 'Discover' && isWriteNetworkAuthorized
                                                && !(onContext.container && onContext.container.group === 'containerUnmanaged')}"
                ></em>{{'enum.DISCOVER' | translate}}</a>
            </li>
            <li
              role="menuitem" ng-show="!onContext.domain"
              ng-class="{'disabled': !cap_change_mode || !policy_mode || policy_mode === 'Monitor'
                || !isWriteNetworkAuthorized || (onContext.container && onContext.container.group === 'containerUnmanaged')}"
            >
              <a
                ng-click="switchServiceMode('Monitor', currentGroup)"
                ng-class="{'disabledMenu': !cap_change_mode || !policy_mode || policy_mode === 'Monitor'
                || !isWriteNetworkAuthorized || (onContext.container && onContext.container.group === 'containerUnmanaged')}"
              >
                <em
                  class="fa fa-bell fa-fw mr-sm"
                  ng-class="{'text-muted': !cap_change_mode || !policy_mode || policy_mode === 'Monitor'
                || !isWriteNetworkAuthorized || (onContext.container && onContext.container.group === 'containerUnmanaged'),
                               'text-monitor': cap_change_mode && policy_mode && policy_mode !== 'Monitor'
                && isWriteNetworkAuthorized && !(onContext.container && onContext.container.group === 'containerUnmanaged')}"
                ></em>{{'enum.MONITOR' | translate}}</a>
            </li>
            <li
              role="menuitem" ng-show="!onContext.domain"
              ng-class="{'disabled': !cap_change_mode || !policy_mode || policy_mode === 'Protect'
                || (onContext.container && onContext.container.group === 'containerUnmanaged') || !isWriteNetworkAuthorized}"
            >
              <a
                ng-click="switchServiceMode('Protect', currentGroup)"
                ng-class="{'disabledMenu': !cap_change_mode || !policy_mode || policy_mode === 'Protect'
                || (onContext.container && onContext.container.group === 'containerUnmanaged') || !isWriteNetworkAuthorized}"
              >
                <em
                  class="fa fa-shield fa-fw mr-sm"
                  ng-class="{'text-muted': !cap_change_mode || !policy_mode || policy_mode === 'Protect'
                || (onContext.container && onContext.container.group === 'containerUnmanaged') || !isWriteNetworkAuthorized,
                               'text-primary': cap_change_mode && policy_mode && policy_mode !== 'Protect'
                && !(onContext.container && onContext.container.group === 'containerUnmanaged') && isWriteNetworkAuthorized}"
                ></em>{{'enum.PROTECT' | translate}}</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="content-title">{{'sidebar.nav.NETWORK_ACTIVITY' | translate}}</div>
  </div>
  <div class="panel mb0">
    <div
      class="panel-body pb0" id="nodeChart"
      ng-style="{ height: graphHeight + 'px'}" oncontextmenu="return false;"
    >
    </div>
  </div>
  <div id="loadingBar" class="loadingBar" style="width: 100%" ng-if="inProgress">
    <md-progress-linear
      class="md-warn" md-mode="buffer" value="{{nodeViewProgres}}"
      md-buffer-value="{{nodeViewProgres2}}"
    ></md-progress-linear>
  </div>

  <div id="legend" class="topLeftLegend p-lg" ng-show="showLegend">
    <ul class="fa-ul">
      <li class="animated fadeInDown anim-delay-5"><em
        class="fa-li fa fa-cloud "
        style="color: #03A9F4"
      ></em>
        <small class="text-muted" translate="{{'network.legend.EXTERNAL'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-5"><em
        class="fa-li fa fa-building-o "
        style="color: #689570"
      ></em>
        <small class="text-muted" translate="{{'network.legend.DOMAIN'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-10"><em
        class="fa-li fa fa-square-o "
        style="color: #3CB9F0"
      ></em>
        <small class="text-muted" translate="{{'network.legend.CONTAINER_DISCOVER'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-10"><em
        class="fa-li fa fa-square-o "
        style="color: #4E39C1"
      ></em>
        <small class="text-muted" translate="{{'network.legend.CONTAINER_MONITOR'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-10"><em
        class="fa-li fa fa-square-o"
        style="color: #186d33"
      ></em>
        <small class="text-muted" translate="{{'network.legend.CONTAINER_PROTECT'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-15"><em
        class="fa-li fa fa-plus "
        style="color: #3CB9F0"
      ></em>
        <small class="text-muted" translate="{{'network.legend.GROUP'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-20"><em
        class="fa-li fa fa-server"
        style="color: #4f6269"
      ></em>
        <small class="text-muted" translate="{{'network.legend.HOST'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-25"><em
        class="fa-li fa fa-square "
        style="color: #3CB9F0"
      ></em>
        <small class="text-muted" translate="{{'network.legend.WORKLOAD'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-25"><em
        class="fa-li fa fa-stop-circle-o"
        style="color: #3CB9F0"
      ></em>
        <small class="text-muted" translate="{{'network.legend.CONTAINER_PROXY'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-30"><em
        class="fa-li fa fa-th-large "
        style="color: #3CB9F0"
      ></em>
        <small class="text-muted" translate="{{'network.legend.IP_GROUP'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-35"><em
        class="fa-li fa fa-long-arrow-right "
        style="color: #2196F3"
      ></em>
        <small class="text-muted" translate="{{'network.legend.NORMAL'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-40"><em
        class="fa-li fa fa-long-arrow-right "
        style="color: #c4cad4"
      ></em>
        <small class="text-muted" translate="{{'network.legend.INTRA_SERVICE'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-45"><em
        class="fa-li fa fa-long-arrow-right "
        style="color: #FDD835"
      ></em>
        <small class="text-muted" translate="{{'network.legend.WARNING'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-50"><em
        class="fa-li fa fa-long-arrow-right "
        style="color: #B71C1C"
      ></em>
        <small class="text-muted" translate="{{'network.legend.DANGER'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-50"><em
        class="fa-li fa fa-long-arrow-right "
        style="color: #FF8A80"
      ></em>
        <small class="text-muted" translate="{{'network.legend.VIOLATION'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-55"><em class="fa-li fa fa-close "></em>
        <small class="text-muted" translate="{{'network.legend.DENY'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-60"><em
        class="fa-li fa fa-circle-o"
        style="color: #3CB9F0"
      ></em>
        <small class="text-muted" translate="{{'network.legend.PROXY'}}"></small>
      </li>
      <li class="animated fadeInDown anim-delay-60"><em
        class="fa-li fa fa-circle-thin"
        style="color: #f76987"
      ></em>
        <small class="text-muted" translate="{{'network.legend.QUARANTINED'}}"></small>
      </li>
    </ul>
  </div>

  <div class="dataBox topRightLimited pt0" ng-show="onNode" ng-cloak>
    <div id="netMonitorLog">
      <div class="col-sm-12 ph0">
        <button class="btn btn-xs btn-link pull-right mt-sm" ng-click="onNode=!onNode">
          <em class="fa fa-times fa-lg text-muted"></em>
        </button>
      </div>
      <uib-tabset justified="true" id="nodeBox">
        <uib-tab index="0">
          <uib-tab-heading>
            {{'enum.SUMMARY' | translate}}
          </uib-tab-heading>
          <ul class="mda-list">
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-credit-card text-muted fa-lg"></em>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'network.nodeDetails.NAME'}}"></h3>
                <small
                  class="text-muted auto-hide" style="display:block; width: 250px;"
                  uib-tooltip="{{container.display_name}}"
                  tooltip-enable="false"
                  show-tooltip-on-text-overflow
                >
                  {{container.display_name}}
                </small>
              </div>
            </li>
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-building-o text-muted fa-lg"></em>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'group.gridHeader.DOMAIN'}}"></h3>
                <small
                  class="text-muted auto-hide" style="display:block; width: 250px;"
                  uib-tooltip="{{container.domain}}"
                  tooltip-enable="false"
                  show-tooltip-on-text-overflow
                >
                  {{container.domain}}
                </small>
              </div>
            </li>
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-gears text-muted fa-lg"></em>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'network.gridHeader.SERVICE'}}"></h3>
                <small
                  class="text-muted mr-lg auto-hide" style="display:block; width: 250px;"
                  uib-tooltip="{{container.service}}"
                  tooltip-enable="false"
                  show-tooltip-on-text-overflow
                >
                  {{container.service}}
                </small>
              </div>
            </li>
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-shield text-muted fa-lg"></em>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'network.nodeDetails.STATE'}}"></h3>
                <small class="text-muted mr-lg" ng-if="container.state !== 'quarantined'">
                  {{container.state}}
                </small>
                <small class="text-danger mr-lg" ng-if="container.state === 'quarantined'">
                  {{container.state}}:&nbsp;
                  {{container.quarantine_reason}}
                </small>
              </div>
            </li>
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-server text-muted fa-lg"/>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'network.nodeDetails.ON_NODE'}}"/>
                <small
                  style="display:block; width: 250px;"
                  uib-tooltip="{{container.host_name}}"
                  tooltip-enable="false"
                  show-tooltip-on-text-overflow
                >
                  <a ui-sref="app.hosts({nodeId: container.host_id})">
                    {{container.host_name}}
                  </a>
                </small>
              </div>
            </li>
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-bug text-muted fa-lg"/>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'group.gridHeader.VULNERABILITIES'}}"/>
                <label class="label label-danger mr-sm" ng-if="container.risk.high">
                  {{container.risk.high}}</label>
                <label class="label label-warning" ng-if="container.risk.medium">
                  {{container.risk.medium}}</label>
                <a
                  ui-sref="app.workloads({imageId: container.id})"
                  style="display: table-cell; font-size: 11px; line-height: 15px;"
                  ng-if="container.risk.high || container.risk.medium"
                >
                  <em class="fa fa-external-link ml-lg"></em>
                </a>

                <label
                  class="label label-success-tran"
                  ng-if="container.risk.high === 0 && container.risk.medium === 0"
                >
                  <em class="fa fa-smile-o mr-sm"/> Clean </label>
              </div>
            </li>
          </ul>
        </uib-tab>
        <uib-tab index="1">
          <uib-tab-heading>
            {{'enum.DETAIL' | translate}}
          </uib-tab-heading>
          <ul class="mda-list">
            <li class="mda-list-item" ng-if="!container.children || container.children.length <= 1">
              <div class="mda-list-item-icon ">
                <em class="fa fa-code text-muted fa-lg"/>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'network.nodeDetails.APPLICATIONS'}}"></h3>
                <div class="row" ng-repeat="(name, ports) in container.app_ports">
                  <div class="col-sm-12 text-left">
                    <strong class="text-muted mr-lg"> {{name}} </strong>
                    <small
                      class="text-muted auto-hide" style="display:block; width: 200px;"
                      uib-tooltip="{{ports}}"
                      tooltip-enable="false"
                      show-tooltip-on-text-overflow
                    >
                      {{ports}}
                    </small>
                  </div>
                </div>
              </div>
            </li>
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em
                  class="fa fa-stop-circle-o text-muted" style="font-size: 1.5em;"
                  ng-if="container.children && container.children.length > 1"
                ></em>
                <em
                  class="fa fa-archive text-muted" ng-if="!container.children ||
                container.children.length <= 1"
                ></em>
              </div>
              <div
                class="mda-list-item-text pb0"
                ng-if="container.children && container.children.length > 1"
              >
                <h3 translate="{{'network.nodeDetails.POD'}}"></h3>
                <div class="row" ng-repeat="child in container.children | filter:{state: '!exit'}">
                  <div class="text-muted text-bold pl-lg" style="display: inline-block">
                    <em class="fa fa-square-o text-muted mr-sm"></em>
                    {{child.display_name | limitTo: 35}}{{child.display_name.length > 35 ? '...' :
                    ''}}
                  </div>
                  <label
                    class="label label-info-tran ml-lg"
                    ng-if="child.service_mesh_sidecar"
                  >
                    Sidecar </label>
                  <div class="row" ng-repeat="(name, ports) in child.app_ports">
                    <div class="col-sm-12 text-left">
                      <em class="fa fa-code text-muted ml-xl mr-sm pull-left"></em>
                      <small class="text-muted text-sm mr-lg pull-left"> {{name}}</small>
                      <small
                        class="text-muted auto-hide pull-left" style="display:block; width: 160px;"
                        uib-tooltip="{{ports}}"
                        tooltip-enable="false"
                        show-tooltip-on-text-overflow
                      >
                        {{ports}}
                      </small>
                    </div>
                  </div>
                  <div class="row"
                  ">
                  <em class="fa fa-archive text-muted ml-xl pl-lg mr-sm pull-left"></em>
                  <small
                    class="text-muted auto-hide pull-left" style="display:block; width: 200px;"
                    uib-tooltip="{{child.image}}"
                    tooltip-enable="false"
                    show-tooltip-on-text-overflow
                  >
                    {{child.image}}
                  </small>
                </div>
              </div>
    </div>
    <div
      class="mda-list-item-text pb0" ng-if="!container.children  ||
               container.children.length <= 1"
    >
      <h3 translate="{{'network.nodeDetails.IMAGE'}}"></h3>
      <div class="row" ng-repeat="image in container.images" style="width: 250px;">
        <small
          class="text-muted pl-lg auto-hide" style="display:block;"
          uib-tooltip="{{image}}"
          tooltip-enable="false"
          show-tooltip-on-text-overflow
        >
          {{image}}
        </small>
      </div>
    </div>
    </li>
    <li class="mda-list-item">
      <div class="mda-list-item-icon ">
        <em class="fa fa-clone text-muted fa-lg"></em>
      </div>
      <div class="mda-list-item-text pb0">
        <h3 translate="{{'sidebar.nav.GROUP'}}"></h3>
        <div class="row" ng-repeat="group in container.groups" style="width: 250px;">
          <small
            class="text-muted pl-lg" style="display:block;"
            uib-tooltip="{{group}}"
            tooltip-enable="false"
            show-tooltip-on-text-overflow
          >
            {{group}}
          </small>
        </div>
      </div>
    </li>
    <li class="mda-list-item">
      <div class="mda-list-item-icon ">
        <em class="fa fa-map-marker text-muted fa-lg"></em>
      </div>
      <div class="mda-list-item-text pb0">
        <h3 translate="{{'network.nodeDetails.IP'}}"></h3>
        <div class="row" ng-repeat="(name, nets) in container.interfaces">
          <div class="col-sm-3 text-left">
            <strong class="text-muted"> {{name}} </strong>
          </div>
          <div class="col-sm-8  col-sm-offset-1 text-muted">
            <div ng-repeat="net in nets">
              <small>{{net.ip}}</small>
            </div>
          </div>
        </div>
      </div>
    </li>

    <li class="mda-list-item">
      <div class="mda-list-item-icon ">
        <em class="fa fa-calendar-plus-o text-muted fa-lg"></em>
      </div>
      <div class="mda-list-item-text pb0">
        <h3 translate="{{'controllers.detail.STARTED_AT'}}"/>
        <small class="text-muted">{{container.started_at | date:'MMM dd, y HH:mm:ss'}}
        </small>
      </div>
    </li>

    <li class="mda-list-item">
      <div class="mda-list-item-icon ">
        <em class="fa fa-calendar-check-o text-muted fa-lg"></em>
      </div>
      <div class="mda-list-item-text pb0">
        <h3 translate="{{'network.nodeDetails.SECURED_AT'}}"></h3>
        <small class="text-muted">{{container.secured_at | date:'MMM dd, y HH:mm:ss'}}
        </small>
      </div>
    </li>
    </ul>
    </uib-tab>
    </uib-tabset>
  </div>
</div>

<div class="dataBox topRightLimited pt0" ng-show="onHost" ng-cloak style="min-width: 350px">
  <button class="btn btn-xs btn-link pull-right mt-sm" ng-click="onHost=!onHost">
    <em class="fa fa-times fa-lg text-muted"></em>
  </button>
  <div>
    <h4 class="text-muted" translate="{{'network.hostDetails.TITLE'}}"></h4>
    <ul class="mda-list">
      <li class="mda-list-item">
        <div class="mda-list-item-icon ">
          <em class="fa fa-credit-card text-muted fa-lg"></em>
        </div>
        <div class="mda-list-item-text pb0">
          <h3 translate="{{'network.nodeDetails.NAME'}}"></h3>
          <small class="text-muted">
            {{host.name | limitTo: 35}}{{host.name.length > 35 ?
            '...' : ''}}
          </small>
        </div>
      </li>
      <li class="mda-list-item">
        <div class="mda-list-item-icon ">
          <em class="fa fa-building-o text-muted fa-lg"></em>
        </div>
        <div class="mda-list-item-text pb0">
          <h3 translate="{{'nodes.detail.OS'}}"></h3>
          <small class="text-muted">
            {{host.os | limitTo: 35}}{{host.os.length > 35 ? '...' : ''}}
          </small>
        </div>
      </li>
      <li class="mda-list-item">
        <div class="mda-list-item-icon ">
          <em class="fa fa-gears text-muted fa-lg"></em>
        </div>
        <div class="mda-list-item-text pb0">
          <h3 translate="{{'nodes.detail.NUM_OF_CPUS'}}"></h3>
          <small class="text-muted mr-lg">
            {{host.cpus}}
          </small>
        </div>
      </li>
      <li class="mda-list-item">
        <div class="mda-list-item-icon ">
          <em class="fa fa-shield text-muted fa-lg"></em>
        </div>
        <div class="mda-list-item-text pb0">
          <h3 translate="{{'nodes.detail.MEMORY'}}"></h3>
          <small class="text-muted mr-lg">
            {{host.memory | bytes}}
          </small>
        </div>
      </li>
      <li class="mda-list-item">
        <div class="mda-list-item-icon ">
          <em class="fa fa-server text-muted fa-lg"/>
        </div>
        <div class="mda-list-item-text pb0">
          <h3 translate="{{'nodes.detail.KERNEL_VERSION'}}"/>
          <small class="text-muted mr-lg">
            {{host.kernel}}
          </small>
        </div>
      </li>
      <li class="mda-list-item">
        <div class="mda-list-item-icon ">
          <em class="fa fa-bug text-muted fa-lg"/>
        </div>
        <div class="mda-list-item-text pb0">
          <h3 translate="{{'group.gridHeader.VULNERABILITIES'}}"/>
          <label class="label label-danger mr-sm" ng-if="host.scan_summary.high">
            {{host.scan_summary.high}}</label>
          <label class="label label-warning" ng-if="host.scan_summary.medium">
            {{host.scan_summary.medium}}</label>
          <a
            ui-sref="app.hosts({nodeId: host.id})"
            style="display: table-cell; font-size: 11px; line-height: 15px;"
            ng-if="host.scan_summary.high || host.scan_summary.medium"
          >
            <em class="fa fa-external-link ml-lg"></em>
          </a>

          <label
            class="label label-success-tran"
            ng-if="!host.scan_summary.high && !host.scan_summary.medium"
          >
            <em class="fa fa-smile-o mr-sm"></em> Clean </label>
        </div>
      </li>
    </ul>
  </div>
</div>

<div id="popupOnChart" class="dataBox" ng-show="onPopup" ng-cloak>
  <ul class="list-unstyled mb0" style="list-style-type: none;">
    <li class="popupItem" ng-disabled="!onContext.unmanagedNode || !isWriteNetworkAuthorized">
      <a ng-click="onAlias = true; onPopup = false">
        <em class="fa fa-tag fa-fw mr-sm"></em>{{'network.popup.ALIAS' | translate}}</a></li>
    <li
      class="popupItem"
      ng-disabled="!onContext.container || (onContext.container && onContext.container.group === 'containerUnmanaged')"
    >
      <a ng-click="showSessions(selectedNodeId)">
        <em class="fa fa-list-alt fa-fw mr-sm"></em>{{'network.nodeDetails.ACTIVE_SESSIONS' |
      translate}}</a></li>
    <li class="popupItem" ng-disabled="!(onContext.container && onContext.container.cap_sniff)">
      <a ng-click="showSniffer(selectedNodeId)">
        <em class="fa fa-video-camera fa-fw mr-sm"></em>{{'network.nodeDetails.SNIFF' |
      translate}}</a></li>
    <li
      class="popupItem"
      ng-disabled="!(onContext.container && onContext.container.cap_quarantine) || !isQuarantineAuthorized"
      ng-if="onContext.container.state !== 'quarantined'"
    >
      <a ng-click="quarantine(selectedNodeId, true)">
        <em class="fa fa-ban text-pink fa-fw mr-sm"></em>
        {{'network.nodeDetails.QUARANTINE' | translate}}</a></li>
    <li
      class="popupItem"
      ng-if="onContext.container && onContext.container.state === 'quarantined' && isQuarantineAuthorized"
    >
      <a ng-click="quarantine(selectedNodeId, false)">
        <em class="fa fa-ban text-pink fa-fw mr-sm"></em>{{'network.nodeDetails.UN_QUARANTINE' |
      translate}}</a></li>
    <li
      class="popupItem sep"
      ng-disabled="!onContext.domain && !onContext.group"
    >
      <a ng-click="onPopup = false; expand(onContext)">
        <em class="fa fa-expand fa-fw mr-sm"></em>{{'network.popup.EXPAND' | translate}}</a>
    </li>
    <li
      class="popupItem"
      ng-disabled="!onContext.domain && !onContext.group"
    >
      <a ng-click="onPopup = false; focus(onContext)">
        <em class="fa fa-dot-circle-o fa-fw mr-sm"></em>{{'network.popup.FOCUS' | translate}}</a>
    </li>
    <li class="popupItem" ng-disabled="onContext.domain">
      <a ng-click="onPopup = false; collapseDomain(onContext)">
        <em class="fa fa-compress fa-fw mr-sm"></em>{{'network.popup.COLLAPSE_DOMAIN' |
      translate}}</a>
    </li>
    <li
      class="popupItem"
      ng-disabled="onContext.domain || groupSelected || groupOnFilter || domainOnFilter"
    >
      <a ng-click="onPopup = false; collapseAllDomains()">
        <em class="fa fa-compress fa-fw mr-sm"></em>{{'network.popup.COLLAPSE_ALL_DOMAINS' |
      translate}}</a>
    </li>
    <li
      class="popupItem"
      ng-disabled="onContext.domain || onContext.group || onContext.ipGroup || isSingleMember || onExpanding"
    >
      <a ng-click="onPopup = false; collapseGroup(onContext)">
        <em
          class="fa fa-compress fa-fw mr-sm"
        ></em>{{'network.popup.COLLAPSE_GROUP' | translate}}</a>
    </li>
    <li
      class="popupItem"
      ng-disabled="onContext.domain || onContext.group || onContext.ipGroup || groupSelected || groupOnFilter || domainOnFilter || onExpanding"
    >
      <a ng-click="onPopup = false; collapseAllGroups()">
        <em class="fa fa-compress fa-fw mr-sm"></em>{{'network.popup.COLLAPSE_ALL_GROUPS' |
      translate}}</a>
    </li>
    <li
      class="popupItem sep" ng-show="!onContext.domain"
      ng-disabled="!cap_change_mode || !policy_mode || policy_mode === 'Discover'
        || (onContext.container && onContext.container.group === 'containerUnmanaged') || !isWriteNetworkAuthorized"
    >
      <a ng-click="switchServiceMode('Discover', currentGroup)">
        <em class="fa fa-binoculars text-discover fa-fw mr-sm"></em>{{'enum.DISCOVER' |
      translate}}</a>
    </li>
    <li
      class="popupItem" ng-show="!onContext.domain"
      ng-disabled="!cap_change_mode || !policy_mode || policy_mode === 'Monitor'
        || (onContext.container && onContext.container.group === 'containerUnmanaged') || !isWriteNetworkAuthorized"
    >
      <a ng-click="switchServiceMode('Monitor', currentGroup)">
        <em class="fa fa-bell text-monitor fa-fw mr-sm"></em>{{'enum.MONITOR' | translate}}</a>
    </li>
    <li
      class="popupItem" ng-show="!onContext.domain"
      ng-disabled="!cap_change_mode || !policy_mode || policy_mode === 'Protect'
        || (onContext.container && onContext.container.group === 'containerUnmanaged') || !isWriteNetworkAuthorized"
    >
      <a ng-click="switchServiceMode('Protect', currentGroup)">
        <em class="fa fa-shield text-primary fa-fw mr-sm"></em>{{'enum.PROTECT' | translate}}</a>
    </li>
  </ul>
</div>

<div id="aliasPopup" class="dataBox" style="width: 400px" ng-show="onAlias" ng-cloak>
  <button class="btn btn-xs btn-link pull-right" ng-click="onAlias=!onAlias">
    <em class="fa fa-times fa-lg text-muted"/>
  </button>
  <!--<h4 class="text-muted pb-sm" translate="{{'network.popup.ALIAS_TITLE'}}"></h4>-->
  <form name="aliasForm" novalidate="" class="form-validate">
    <md-input-container class="md-block mb0 nv-container">
      <label translate="{{'network.popup.ALIAS_TITLE'}}"/>
      <md-icon aria-label="alias name">
        <div class="circle-icon">
          <em class="fa fa-tag text-primary fa-lg"/>
        </div>
      </md-icon>
      <input
        required name="alias" ng-model="alias" placeholder="{{nextName}}"
        maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
      >
    </md-input-container>
    <button
      type="button" class="btn btn-default btn-wide pull-right"
      ng-disabled="aliasForm.$invalid || !aliasForm.alias.$dirty"
      ng-click="saveAlias(selectedNodeId, alias)"
    >{{'setting.SUBMIT' | translate}}
    </button>
  </form>
</div>

<div id="conversationHistory" class="dataBox topLeftSession resizable" ng-show="onEdge">
  <button class="btn btn-xs btn-link pull-right" ng-click="onEdge=!onEdge">
    <em class="fa fa-times fa-lg text-muted"></em>
  </button>
  <div>
    <h4 class="text-muted mb0">{{conversationDetail.from.display_name}}
      <em class="fa fa-long-arrow-right text-info"></em>
                               {{conversationDetail.to.display_name}}</h4>
  </div>
  <div class="clearfix" ng-if="entries && entries.length > 0">
    <div class="left-inner-addon pull-right mb-sm">
      <em class="fa fa-filter text-filter"></em>
      <input
        class="search form-control" placeholder="{{'general.FILTER' | translate}}"
        type="text" maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
        ng-model="search"
        ng-paste="onConvHisFilterChanged(search)"
        ng-keyup="onConvHisFilterChanged(search)"
      />
    </div>
  </div>
  <div ng-if="entries && entries.length > 0">
    <div
      ag-grid="convHisGridOptions" class="ag-grid" style="width: 100%;"
      ng-style="{ height: entriesGridHeight + 'px'}"
    >
    </div>
  </div>
  <div ng-if="!entries || entries.length === 0" class="pv-lg">
    <div class="text-info" style="font-size: 16px">
      <em class="fa fa-info-circle mr-lg" aria-hidden="true"></em>
      {{'general.NO_CONVERSATIONS' | translate}}
    </div>
  </div>
  <div class="col-sm-5 mt-sm">
      <span
        ng-if="entries && entries.length > 0"
        class="text-muted mr-lg"
      >{{'network.edgeDetails.SESSIONS' | translate}} {{sessionCount}}</span>
    <span class="label label-warning" ng-if="onViolation"><em class="fa fa-ban mr-sm"></em>
        {{'network.edgeDetails.VIOLATION' | translate}} </span>
    <span class="label label-danger" ng-if="onThreat"><em class="fa fa-bug mr-sm"></em>
        {{'network.edgeDetails.THREAT' | translate}} </span>
  </div>
  <div class="col-sm-4 col-sm-offset-3">
    <div class="pull-right">
      <button
        ng-show="showRuleId && traffic.policy_action !== 'open'" type="button"
        class="btn btn-wide btn-default mt-sm"
        ng-disabled="!isWriteNetworkAuthorized"
        ng-click="overrideRule(traffic, edgeDetail)"
      >
        <em class="fa fa-pencil-square-o"></em> {{'network.edgeDetails.OVERRIDE_RULE' | translate}}
      </button>
      <button
        type="button" class="btn btn-wide btn-default mt-sm"
        ng-if="isClearSessionAuthorized && entries && entries.length > 0"
        ng-disabled="!isWriteNetworkAuthorized"
        ng-click="clearSessions(conversationDetail.from.id, conversationDetail.to.id)"
      >
        <em class="fa fa-magic mr-sm"></em>{{'network.edgeDetails.CLEAR' | translate}}
      </button>
    </div>
  </div>
</div>

<div id="activeSessions" class="dataBox topLeftSession resizable" ng-show="onActiveSession">
  <button
    class="btn btn-xs btn-link pull-right"
    ng-click="stopRefreshSession(); onActiveSession =false"
  >
    <em class="fa fa-times fa-lg text-muted"></em>
  </button>
  <div class="pull-right">
    <div class="md-switch2">
      <label class=" pull-right mr-sm">
        <em class="fa fa-spinner fa-spin text-info" ng-show="autoRefresh"></em>
        <small class="text-muted">{{'network.AUTO_REFRESH' | translate}}</small>
        <input
          type="checkbox" ng-model="autoRefresh"
          ng-change="toggleRefresh(autoRefresh)"
        />
        <span class="toggle"></span>
      </label>
    </div>

  </div>
  <h4 class="text-dark mb0">
    {{'dashboard.panelItems.NETWORK_TRAFFIC' | translate}}&nbsp;-&nbsp;{{currentName}}</h4>
  <div class="clearfix" ng-if="conversations && conversations.length > 0">
    <div class="left-inner-addon pull-right mb-sm">
      <em class="fa fa-filter text-filter"/>
      <input
        class="search form-control" placeholder="{{'general.FILTER' | translate}}"
        type="text" maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
        ng-model="search"
        ng-paste="onActiveSessionFilterChanged(search)"
        ng-keyup="onActiveSessionFilterChanged(search)"
      />
    </div>
  </div>
  <div ng-if="conversations && conversations.length > 0">
    <div
      ag-grid="activeGridOptions" class="ag-grid" style="width: 100%;"
      ng-style="{ height: activeSessionGridHeight + 'px'}"
    >
    </div>
  </div>
  <div class="mv-sm" ng-if="conversations.length==0">
    <span translate="{{'network.NO_ACTIVE_SESSIONS'}}"> </span>
  </div>
</div>

<div id="sniffer" class="dataBox topLeftSession resizable" ng-show="onSniffer">
  <button class="btn btn-xs btn-link pull-right" ng-click="onSniffer=!onSniffer">
    <em class="fa fa-times fa-lg text-muted"></em>
  </button>
  <h4 class="text-dark">{{'network.nodeDetails.SNIFF' | translate}}
    <em class="fa fa-long-arrow-right text-info mh-sm"></em>{{containerName}}
  </h4>

  <div style="padding-bottom: 10px">
    <div
      ag-grid="sniffGridOptions" class="ag-grid" style="width: 100%;"
      ng-style="{ height: snifferGridHeight + 'px'}"
    >
    </div>
  </div>
  <div layout="row" class="mb">
    <div flex="20">
      <md-checkbox
        class="md-primary ml-sm mt-lg"
        ng-checked="!pcap.options.disabled" ng-disabled=""
        ng-click="toggleSchedule()"
      >
        <label ng-class="pcap.options.disabled ? 'text-muted' : 'text-primary'">
          {{'network.SCHEDULE_JOB' | translate}}
        </label>
      </md-checkbox>
    </div>
    <div flex="50">
      <rzslider
        class="custom-slider"
        rz-slider-model="pcap.seconds"
        rz-slider-options="pcap.options"
      >
      </rzslider>
    </div>

  </div>
  <div layout="row">
    <div flex="70">
      <button
        class="btn btn-xs btn-circle btn-primary"
        ng-disabled="!isPacketCapAuthorized || disableStart()"
        ng-click="startSniff(containerId)"
      >
        <em class="fa fa-play"></em>
      </button>
    </div>
    <div flex="20">
      <a
        type="submit" class="btn btn-primary btn-xs" target="_self"
        ng-show="sniffer && downloadId === sniffer.id"
        download="{{exportFilename}}" ng-href="{{exportUrl}}"
      >
        <span>
          <em class="fa fa-cloud-download">&nbsp;{{'network.DOWNLOAD' | translate}}</em>
        </span>
      </a>
    </div>
    <div flex="30">
      <div class="pull-right">
        <button
          class="btn btn-xs btn-circle btn-primary"
          ng-disabled="!isPacketCapAuthorized || !sniffer || sniffer.status === 'stopped'"
          ng-click="stopSniff(sniffer.id)"
        >
          <em class="fa fa-stop"></em>
        </button>
        <button
          class="btn btn-xs btn-circle btn-primary"
          ng-disabled="!isPacketCapAuthorized || !sniffer"
          ng-click="downloadPacket(sniffer.id)"
        >
          <em class="fa fa-file-archive-o"></em>
        </button>
        <button
          class="btn btn-xs btn-circle btn-pink"
          ng-disabled="!isPacketCapAuthorized || !sniffer" ng-click="deleteSniff(sniffer.id)"
        >
          <em class="fa fa-trash"></em>
        </button>
      </div>
    </div>
  </div>

</div>

<div class="dataBox topLeftMid resizable" ng-show="onRule">
  <button class="btn btn-xs btn-link pull-right" ng-click="onRule=!onRule">
    <em class="fa fa-times fa-lg text-muted"></em>
  </button>
  <h4 ng-show="rule.id !== 0">{{'policy.RULE_DETAILS' | translate}}
    <em class="fa fa-hand-o-right ml-sm text-primary"></em>
    <small>{{rule.id}}</small>
  </h4>
  <h4 ng-show="rule.id === 0">{{'policy.NEW_RULE' | translate}}
    <em class="fa fa-plus-square-o ml-sm text-primary"></em></h4>
  <div>
    <form name="ruleForm" novalidate="">
      <div class="col-sm-6">
        <md-input-container class="md-block mb0">
          <label>{{'policy.editPolicy.FROM' | translate}}</label>
          <input disabled ng-model="rule.from"/>
        </md-input-container>
      </div>
      <div class="col-sm-6">
        <md-input-container class="md-block mb0">
          <label>{{'policy.editPolicy.TO' | translate}}</label>
          <input disabled ng-model="rule.to"/>
        </md-input-container>
      </div>
      <div class="col-sm-6 mb0">
        <md-input-container class="md-block mb0">
          <label>{{'policy.addPolicy.APP' | translate}}</label>
          <input disabled value="{{rule.applications.join(', ')}}"/>
        </md-input-container>
      </div>
      <div class="col-sm-6 mb0">
        <md-input-container class="md-block mb0">
          <label>{{'policy.editPolicy.PORT' | translate}}</label>
          <input disabled value="{{rule.ports}}"/>
        </md-input-container>
      </div>

      <div class="col-sm-4 mb0" ng-if="rule.created_timestamp">
        <md-input-container class="md-block">
          <label>{{'controllers.detail.CREATED_AT' | translate}}</label>
          <input
            disabled
            value="{{rule.created_timestamp * 1000 | date:'MMM dd, y HH:mm:ss'}}"
          />
        </md-input-container>
      </div>
      <div class="col-sm-4 mb0" ng-if="rule.last_modified_timestamp">
        <md-input-container class="md-block">
          <label>{{'policy.gridHeader.UPDATE_AT' | translate}}</label>
          <input
            disabled
            value="{{rule.last_modified_timestamp * 1000 | date:'MMM dd, y HH:mm:ss'}}"
          />
        </md-input-container>
      </div>
      <div class="col-sm-2 mb0" style="margin-top: 25px;">
        <div
          ng-if="rule.learned" class="action-label nv-label learn-rule "
          translate="{{'group.LEARNED'}}"
        >
        </div>
        <div
          ng-if="!rule.learned" class="action-label nv-label customer-rule"
          translate="{{'group.CUSTOM'}}"
        >
        </div>
      </div>
      <div class="col-sm-2 mb0">
        <label class="text-muted">{{'policy.editPolicy.DENY_ALLOW' | translate}}</label>
        <div>
          <nz-toggle
            class="mt0"
            width="50"
            color-false="'#ff8a65'"
            color-true="'#81c784'"
            ng-model="rule.allowed"
            ng-disabled="!isWriteNetworkAuthorized || rule.action === 'open'"
            val-true="true"
            val-false="false"
          >
          </nz-toggle>
        </div>
      </div>
      <button
        ng-if="isWriteNetworkAuthorized" class="btn btn-primary btn-xs pull-right mt-lg"
        ng-click="updateRule(rule)"
      >
        <em class="fa fa-save mr-sm"></em>{{'policy.portlet.SUBMIT' | translate}}
      </button>
    </form>
  </div>
</div>

<div
  id="groupBox" class="dataBox topRightLimited pt0" ng-show="onGroupNode"
  style="min-width: 400px"
>
  <button class="btn btn-xs btn-link pull-right" ng-click="onGroupNode=!onGroupNode">
    <em class="fa fa-times fa-lg text-muted"></em>
  </button>
  <div>
    <h4 class="text-muted" translate="{{'group.GROUP_DETAILS'}}"></h4>
    <ul class="mda-list">
      <li class="mda-list-item">
        <div class="mda-list-item-icon ">
          <em class="fa fa-credit-card text-muted fa-lg"></em>
        </div>
        <div class="mda-list-item-text pb0">
          <h3 translate="{{'network.nodeDetails.NAME'}}"></h3>
          <small class="text-muted">
            {{group.name | limitTo: 35}}{{group.name.length > 35 ? '...' : ''}}
          </small>
        </div>
      </li>
      <li class="mda-list-item">
        <div class="mda-list-item-icon ">
          <em class="fa fa-leanpub text-muted fa-lg"></em>
        </div>
        <div class="mda-list-item-text pb0">
          <h3 translate="{{'group.LEARNED'}}"></h3>
          <small class="text-muted">
            {{group.learned}}
          </small>
        </div>
      </li>
      <li class="mda-list-item">
        <div class="mda-list-item-icon ">
          <em class="fa fa-sitemap text-muted fa-lg"></em>
        </div>
        <div class="mda-list-item-text pb0">
          <h3 translate="{{'group.gridHeader.MEMBERS'}}"></h3>
          <small class="text-muted">
            {{group.members.length}}
          </small>
        </div>
      </li>
      <li class="mda-list-item">
        <div class="mda-list-item-icon ">
          <em class="fa fa-shield text-muted fa-lg"></em>
        </div>
        <div class="mda-list-item-text pb0">
          <h3 translate="{{'group.gridHeader.POLICY_MODE'}}"></h3>
          <small class="text-muted">
            {{group.policy_mode}}
          </small>
        </div>
      </li>
      <li class="mda-list-item">
        <div class="mda-list-item-icon ">
          <em class="fa fa-list-ol text-muted fa-lg"></em>
        </div>
        <div class="mda-list-item-text pb0">
          <h3 translate="{{'group.gridHeader.USED_BY_RULES'}}"></h3>
          <small class="text-muted">
            {{getGroupRules(group)}}
          </small>
        </div>
      </li>
      <li class="mda-list-item">
        <div class="mda-list-item-icon ">
          <em class="fa fa-list-ol text-muted fa-lg"></em>
        </div>
        <div class="mda-list-item-text pb0">
          <h3 translate="{{'group.gridHeader.USED_BY_RESPONSE_RULES'}}"></h3>
          <small class="text-muted">
            {{getGroupResponseRules(group)}}
          </small>
        </div>
      </li>
      <li class="mda-list-item">
        <div class="mda-list-item-icon ">
          <em class="fa fa-bug text-muted fa-lg"></em>
        </div>
        <div class="mda-list-item-text pb0">
          <h3 translate="{{'group.gridHeader.VULNERABILITIES'}}"></h3>
          <label class="label label-danger mr-sm" ng-if="groupVulnerabilities.high">
            {{groupVulnerabilities.high}}</label>
          <label class="label label-warning" ng-if="groupVulnerabilities.medium">
            {{groupVulnerabilities.medium}}</label>
          <label
            class="label label-success-tran"
            ng-if="groupVulnerabilities.high === 0 && groupVulnerabilities.medium === 0"
          >
            <em class="fa fa-smile-o mr-sm"></em> {{'scan.NO_VULNERABILITIES' | translate}}
          </label>
        </div>
      </li>

    </ul>
  </div>

</div>

<div id="zoom" class="zoomActionContainer">
  <div class="zoomBox zoomAction p-sm" ng-click="zoomStepIn()">
    <em class="fa fa-plus fa-lg" style="color: #899AA7;"></em>
  </div>
  <div class="zoomAction p-sm" ng-click="zoomStepOut()">
    <em class="fa fa-minus fa-lg" style="color: #899AA7;"></em>
  </div>
</div>

<script type="text/ng-template" id="customTemplate.html">
  <div class="tag-template">
    <div class="left-panel">
      <em
        class="fa mr-sm"
        ng-class="{'fa-clone text-primary': data.type === 'group',
                  'fa-building-o text-green': data.type ==='domain'}"
      >
      </em>
    </div>
    <div class="right-panel">
      <span>{{$getDisplayText()}}</span>
      <a class="remove-button" ng-click="$removeTag()">&#10006;</a>
    </div>
  </div>
</script>
<script type="text/ng-template" id="autocomplete-template">
  <div class="autocomplete-template">
    <div class="right-panel">
      <i
        class="fa mr-sm"
        ng-class="{'fa-clone text-primary': data.type === 'group',
                  'fa-building-o text-green': data.type ==='domain'}"
      >
      </i>
      <span ng-bind-html="$highlight($getDisplayText())"></span>
    </div>
  </div>
</script>

</div>
