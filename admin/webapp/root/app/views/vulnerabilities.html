<div ng-controller="VulnerabilityController">
  <!-- <div style="position: absolute; top: 20px; right: 495px; z-index: 2; width: 250px;"
    class="text-gray-label hand"
    ng-click="toggleShowingAcceptedVuls(isShowingAccepted)"
  >
    <em class="fa"
      ng-class="{'fa-eye': !isShowingAccepted, 'fa-eye-slash': isShowingAccepted}"
      ></em>
    {{ isShowingAccepted ? 'enum.HIDE_ACCEPTED_VULS' : 'enum.SHOW_ACCEPTED_VULS' | translate | uppercase}}
  </div> -->
  <div
    class="text-muted"
    style="position: absolute; top: 20px; right: 95px; z-index: 2; width: 400px;"
    ng-if="vulnerabilities.length > 0 && !cvesErr"
  >
    <div class="col-xs-5 p0">
      <div ng-if="!isPdfPreparing2">
        <div ng-if="progress2<100">
          <em class="fa fa-file-pdf-o disabled" style="margin-left:10px;"></em>
          <span class="text-disabled-label disabled">{{'scan.report.PDF_LINK2' | translate}}</span>
        </div>
        <div
          ng-if="progress2<100"
          class="loader5"
          style="position: absolute; top: 6px; left: 30px;"
        ></div>
        <div
          ng-if="progress2<100"
          style="position: absolute; top: 2px; left: 22px; font-size: 12px; color: #11330f"
        >
          {{progress2}}%
        </div>
        <div ng-click="downloadPdf2()" ng-if="progress2===100">
          <em
            class="fa fa-file-pdf-o pdf-color hand"
            style="margin-left:10px;"
          ></em>
          <span class="text-gray-label link">{{'scan.report.PDF_LINK2' | translate}}</span>
        </div>
      </div>
      <div ng-if="isPdfPreparing2">
        <em class="fa fa-file-pdf-o disabled" style="margin-left:10px;"></em>
        <span class="text-disabled-label disabled">{{'scan.report.PDF_LINK2' | translate}}</span>
        <div
          class="loader5"
          style="position: absolute; top: 6px; left: 30px;"
        ></div>
      </div>
    </div>
    <div class="col-xs-5 p0">
      <div ng-if="!isPdfPreparing">
        <div ng-if="progress<100">
          <em class="fa fa-file-pdf-o disabled" style="margin-left:10px;"></em>
          <span class="text-disabled-label disabled">{{'scan.report.PDF_LINK' | translate}}</span>
        </div>
        <div
          ng-if="progress<100"
          class="loader5"
          style="position: absolute; top: 6px; left: 30px;"
        ></div>
        <div
          ng-if="progress<100"
          style="position: absolute; top: 2px; left: 22px; font-size: 12px; color: #11330f"
        >
          {{progress}}%
        </div>
        <div ng-click="downloadPdf()" ng-if="progress===100">
          <em
            class="fa fa-file-pdf-o pdf-color hand"
            style="margin-left:10px;"
          ></em>
          <span class="text-gray-label link">{{'scan.report.PDF_LINK' | translate}}</span>
        </div>
      </div>
      <div ng-if="isPdfPreparing">
        <em class="fa fa-file-pdf-o disabled" style="margin-left:10px;"></em>
        <span class="text-disabled-label disabled">{{'scan.report.PDF_LINK' | translate}}</span>
        <div
          class="loader5"
          style="position: absolute; top: 6px; left: 30px;"
        ></div>
      </div>
    </div>
    <div
      ng-click="exportCsv()"
      ng-if="vulnerabilities.length && (!isPdfPreparing || !isPdfPreparing2)"
      class="col-xs-2 p0"
    >
      <em
        class="fa fa-file-excel-o xls-color hand"
        style="margin-left:10px;"
      ></em>
      <span class="text-gray-label link">CSV</span>
    </div>
  </div>
  <div
    ng-click="refresh()"
    style="position: absolute; top: 20px; right: 20px; z-index: 2"
  >
    <em class="fa fa-refresh text-action"></em>
    <label class="text-gray-label hand"
    >{{'general.REFRESH' | translate}}</label
    >
  </div>
  <!--    <div class="content-title">{{'sidebar.nav.SCAN' | translate}}</div>-->

  <div class="clearfix">
    <!-- <div class="col-sm-6" style="height: 180px; margin-top: 20px;">
      <canvas
        id="bar12"
        class="chart chart-bar"
        chart-data="data"
        chart-labels="labels"
        chart-series="series"
        chart-colors="colors"
        chart-options="options"
        chart-hover="onHover"
      >
      </canvas>
    </div> -->
    <div class="col-sm-5 mb" style="height: 180px; margin-top: 20px;">
      <canvas
        id="bar12"
        class="chart chart-horizontal-bar"
        chart-data="cveHostData"
        chart-labels="cveHostLabels"
        chart-series="cveSeries"
        chart-colors="cveColors"
        chart-dataset-override="cveOverride"
        chart-options="cveHostOptions"
      >
      </canvas>
    </div>
    <div class="col-sm-7 mb" style="height: 180px; margin-top: 20px;">
      <canvas
        id="bar22"
        class="chart chart-horizontal-bar"
        chart-data="cveData"
        chart-labels="cveLabels"
        chart-series="cveSeries"
        chart-colors="cveColors"
        chart-dataset-override="cveOverride"
        chart-options="cveOptions"
      >
      </canvas>
    </div>
    <div
      style="width: 1100px; height: 250px; position: absolute; left: 0; top: 0; visibility: hidden;"
    >
      <canvas
        id="bar12PDF"
        class="chart chart-horizontal-bar"
        chart-data="cveHostData"
        chart-labels="cveHostLabels"
        chart-series="cveSeries"
        chart-colors="cveColors"
        chart-dataset-override="cveOverride"
        chart-options="cveHostOptions"
      >
      </canvas>
    </div>
    <div
      style="width: 1100px; height: 250px; position: absolute; left: 0; top: 0; visibility: hidden;"
    >
      <canvas
        id="bar22PDF"
        class="chart chart-horizontal-bar"
        chart-data="cveData"
        chart-labels="cveLabels"
        chart-series="cveSeries"
        chart-colors="cveColors"
        chart-dataset-override="cveOverride"
        chart-options="cveOptions4Pdf"
      >
      </canvas>
    </div>
  </div>
  <div class="panel mb0">
    <div class="panel-body">
      <div class="col-lg-7">
        <div class="clearfix">
          <div class="pull-left">
            <label class="text-primary pull-left mt-sm" ng-show="!cvesErr"
                   style="margin-right: 20px"
            >{{count}} </label>
            <div class="pull-left mr" style="margin-top: 2px;"
              ng-show="cve && !isAccepted" display-control="write_vuls_profile">
              <button
                type="button"
                style="padding: 3px 3px;"
                class="btn btn-default pull-right"
                ng-click="acceptVulnerability($event, cve)"
              >
                <em class="fa fa-check-square-o mr-sm"></em>{{ 'cveProfile.ACCEPT' | translate}}
              </button>
            </div>
            <label uib-dropdown class="pull-left mt-sm mr-lg">
              <div uib-dropdown-toggle>
                <div>
                  <label class="text-gray-label hand"
                  >{{scoreType}}</label
                  >
                  <em
                    class="fa fa-caret-down text-action ml-sm"
                    ng-click="toggleCollapse()"
                  ></em>
                </div>
              </div>
              <ul
                class="dropdown-menu"
                uib-dropdown-menu
                role="menu"
                aria-labelledby="single-button"
              >
                <li role="menuitem" >
                  <a ng-click="toggleScore('v2')">
                    {{"scan.gridHeader.SCORE_V2" | translate}}</a>
                </li>
                <li role="menuitem" >
                  <a ng-click="toggleScore('v3')">
                    {{"scan.gridHeader.SCORE_V3" | translate}}</a>
                </li>
              </ul>
            </label>
            <div class="pull-left" ng-show="cve">
              <em
                class="fa fa-area-chart fa-lg text-action hand mt"
                ng-click="clearSelection()"
              ></em>
            </div>
          </div>
          <div class="pull-right">
            <div
              class="left-inner-addon pull-left ml mr-lg"
              style="margin: 5px auto;"
              ng-click="showFilter()"
              ng-show="vulnerabilities.length>0"
            >
              <i ng-if="!isAdvFilterOn()" class="fa fa-search text-filter"></i>
              <i ng-if="isAdvFilterOn()" class="fa fa-check text-primary"></i>
              <span
                class="ml-sm text-muted"
                ng-class="{'text-primary': isAdvFilterOn()}"
              >{{'general.ADV_FILTER' | translate}}</span
              >
            </div>
            <div
              class="left-inner-addon pull-left ml-lg"
              style="margin-bottom: 5px"
            >
              <em class="fa fa-filter text-filter"></em>
              <input
                class="search form-control"
                placeholder="{{'general.FILTER' | translate}}"
                type="text"
                maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
                ng-model="search"
                ng-paste="onFilterChanged(search)"
                ng-keyup="onFilterChanged(search)"
              />
            </div>
          </div>
        </div>
        <div
          id="cveGrid"
          ag-grid="gridOptions"
          class=" ag-grid"
          ng-style="{ height: (graphHeight - 140) + 'px'}"
        ></div>
      </div>
      <div
        class="col-lg-5"
        ng-style="{ height: (graphHeight - 110) + 'px'}"
        ng-if="cve"
      >
        <div layout="row">
          <h4 flex="90" class="mt-sm mb0 text-warning">
            {{'scan.report.gridHeader.PACKAGES' | translate}}
          </h4>
          <div
            class="label label-info pull-right mt-sm pv0"
            style="height: 16px; width: 76px;"
            ng-click="toggleLegend()"
          >
            <div class="pull-left" style="margin-top:2px;" >
              <svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"  width="10" height="12" fill="#fff">
                <path d="M334.016 727.04a32 32 0 1 0 0-64 32 32 0 0 0 0 64z m0-183.04a32 32 0 1 0 0-64 32 32 0 0 0 0 64z m0-182.016a32 32 0 1 0 0-64 32 32 0 0 0 0 64z m478.976-279.04H211.008c-37.568 0.064-67.968 30.528-68.032 68.032v722.048c0.064 37.504 30.464 67.968 68.032 67.968h601.984c37.568 0 67.968-30.464 68.032-67.968V150.976c-0.064-37.504-30.464-67.968-68.032-67.968z m-3.968 786.048H214.976V155.008h594.048v713.984zM414.016 296h307.968c5.376 0 8 2.688 8 8v48c0 5.312-2.624 8-8 8H414.08c-5.376 0-8-2.688-8-8v-48c0-5.312 2.624-8 8-8z m0 184h307.968c5.376 0 8 2.688 8 8v48c0 5.312-2.624 8-8 8H414.08c-5.376 0-8-2.688-8-8v-48c0-5.312 2.624-8 8-8z m0 184h307.968c5.376 0 8 2.688 8 8v48c0 5.312-2.624 8-8 8H414.08c-5.376 0-8-2.688-8-8v-48c0-5.312 2.624-8 8-8z">
                </path>
              </svg>
            </div>
            <div class="pull-left ml-sm" style="margin-top:4px;">{{ 'network.legend.TITLE' | translate}}</div>
          </div>
        </div>
        <hr class="fancy mv-sm" />
        <div ng-style="{ height: ((graphHeight - 140) / 2 -25) + 'px'}"
             style="overflow: auto">
          <div ng-repeat="(key, value) in cve.Packages">
            <label class="mt-sm mb0 text-info auto-hide">{{key}}</label>
            <table
              id="packageVersions"
              class="table-striped fixed_header"
              style="width: 100%"
            >
              <thead class="critical-row">
              <tr class="summary-title">
                <th>
                  <em class="fa fa-bug text-warning mh-sm"></em>
                  {{"scan.report.data.IMPACTED" | translate}}
                </th>
                <th>
                  <em class="fa fa-lightbulb-o text-primary mh-sm"></em>
                  {{"scan.report.data.FIXED" | translate}}
                </th>
              </tr>
              </thead>
              <tbody>
              <tr ng-repeat="package in value">
                <td>
                  {{package.package_version}}
                </td>
                <td>
                  {{package.fixed_version}}
                </td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>

        <h4 class="text-warning mb0">
          {{"scan.report.gridHeader.IMPACT" | translate}}
        </h4>
        <hr class="fancy mv-sm" />
        <div
          ng-style="{ height: ((graphHeight - 140) / 2 -25) + 'px'}"
          style="overflow: auto;"
        >
          <h5 ng-if="cve.platforms.length" class="text-bold">
            {{"scan.report.data.PLATFORMS" | translate}}
          </h5>
          <div ng-if="cve.platforms.length">
            <span
              class="label mr-lg"
              ng-repeat="node in cve.platforms"
              ng-class="labelType(node.policy_mode)"
              style="display: inline-block; background-color: #f22d3a;"
            >
              <em class="fa fa-building-o mr-sm"></em>
              {{node.display_name}}
            </span>
          </div>
          <h5 ng-if="cve.images.length" class="text-bold">
            {{"scan.report.data.IMAGES" | translate}}
          </h5>
          <div ng-if="cve.images.length">
            <span
              class="label mr-lg"
              ng-repeat="node in cve.images | limitTo : 100"
              ng-class="labelType(node.policy_mode)"
              style="display: inline-block;"
            >
              <em class="fa fa-archive mr-sm"></em>
              {{node.display_name}}
            </span>
          </div>
          <h5 ng-if="cve.nodes.length" class="text-bold">
            {{"scan.report.data.NODES" | translate}}
          </h5>
          <div ng-if="cve.nodes.length">
            <span
              class="label mr-lg"
              ng-repeat="node in cve.nodes | limitTo : 100"
              ng-class="labelType(node.policy_mode)"
              style="display: inline-block;"
              ng-click="showHost(node.id)"
            >
              <em class="fa fa-server mr-sm"></em>
              {{node.display_name}}
            </span>
          </div>
          <h5 ng-if="cve.workloads.length" class="text-bold">
            {{"scan.report.data.CONTAINERS" | translate}}
          </h5>
          <div ng-if="cve.workloads.length">
            <span
              class="label mr-lg"
              ng-repeat="workload in cve.workloads | filter : namespaceFilter | limitTo : 100"
              ng-class="labelType(workload.policy_mode)"
              style="display: inline-block"
              ng-click="showWorkload(workload.id)"
            >
              <em class="fa fa-square-o mr-sm"></em>
              {{workload.display_name}}
            </span>
          </div>
        </div>
      </div>
      <div
        class="col-lg-5"
        ng-style="{ height: (graphHeight - 140) + 'px'}"
        ng-if="!cve"
      >
        <div
          ng-style="{ height: ((graphHeight - 140) / 2) + 'px'}"
          ng-if="!cve"
        >
          <canvas
            id="severityDis"
            class="chart chart-doughnut"
            chart-colors="sdColors"
            chart-options="sdLegend"
            chart-data="sdData"
            chart-labels="sdName"
            chart-dataset-override="sdOverride"
          >
          </canvas>
        </div>
        <div
          ng-style="{ height: ((graphHeight - 140) / 2) + 'px'}"
          ng-if="!cve"
        >
          <canvas
            id="entityDis"
            class="chart chart-doughnut"
            chart-colors="colors"
            chart-options="entLegend"
            chart-data="entData"
            chart-labels="series"
            chart-dataset-override="sdOverride"
          >
          </canvas>
        </div>
      </div>
    </div>
  </div>

  <div id="cve" class="dataBox topLeft80 pl-sm" ng-show="onCVE">
    <em class="fa fa-times pull-right pr-sm pt-sm" ng-click="onCVE=false"></em>
    <h4 class="ml-lg">
      {{cveName}}
      <a ng-href="{{cveLink}}" target="_blank"
      ><em class="fa fa-external-link"></em
      ></a>
    </h4>
    <blockquote style="font-size: 13px">
      <p>{{cveDescription}}</p>
    </blockquote>
    <h5 class="ml-lg mv-sm" ng-if="cveVector">
      CVSS Vector
    </h5>
    <blockquote style="font-size: 13px" ng-if="cveVector">
      <p>{{cveVector}}</p>
    </blockquote>
    <div ng-if="cveScoreV2" class="pull-right">
      CVSS Version 2.0: {{cveScoreV2}}
    </div>
  </div>

  <div
    id="filter"
    class="dataBox advFilter"
    ng-show="onAdvFilter"
    style="border: none"
  >
    <form name="advFilterForm" novalidate>
      <div layout="row" layout-align="space-between center" class="ml0 mr0">
        <h4 class="text-bold mb0 pl-lg">
          {{"general.FILTER_MATCH_ALL" | translate}}
        </h4>
        <div>
          <md-button class="md-icon-button" ng-click="onAdvFilter=false">
            <md-icon
              md-svg-src="app/img/icons/ic_close_24px.svg"
              aria-label="Close dialog"
            ></md-icon>
          </md-button>
        </div>
      </div>
      <hr class="fancy mv-sm" />
      <div layout="row" class="mt-sm">
        <div
          flex="20"
          class="text-bold text-muted ph-lg"
          style="margin-top: 20px"
        >
          <em
            class="fa mr-sm"
            ng-class="advFilter.dt ? 'fa-calendar-check-o text-primary' : 'fa-calendar-o text-action'"
          ></em>
          {{"scan.PUBLISHED" | translate}}
        </div>
        <div flex="20" uib-dropdown style="margin-top: 20px">
          <div uib-dropdown-toggle>
            <div>
              <label class="text-gray-label hand"
              >{{advFilter.publishedType.name}}</label
              >
              <em
                class="fa fa-caret-down text-action ml-sm"
                ng-click="toggleCollapse()"
              ></em>
            </div>
          </div>
          <ul
            class="dropdown-menu"
            uib-dropdown-menu
            role="menu"
            aria-labelledby="single-button"
          >
            <li role="menuitem" ng-repeat="dateType in dateTypes">
              <a ng-click="setPublishedType(dateType)">{{dateType.name}}</a>
            </li>
          </ul>
        </div>
        <div flex="50">
          <div class="input-group mt">
            <input
              type="text"
              class="form-control"
              uib-datepicker-popup="{{format}}"
              ng-model="advFilter.dt"
              is-open="advFilter.popup.opened"
              datepicker-options="dateOptions"
              name="advDate"
            />
            <span class="input-group-btn">
              <button
                type="button"
                class="btn btn-default"
                ng-click="openDate()"
              >
                <em class="fa fa-calendar"></em>
              </button>
            </span>
          </div>
          <span class="text-danger" ng-show="!advFilterForm.advDate.$valid">
            {{"scan.INVALID_DATE" | translate}}</span>
        </div>
      </div>
      <div layout="row" class="mt-lg">
        <div flex="20" class="text-bold text-muted ph-lg">
          {{"scan.gridHeader.PACKAGE_NAME" | translate}}
        </div>
        <div flex="80">
          <md-radio-group layout="row" ng-model="advFilter.packageType">
            <md-radio-button value="all" flex="20" class="md-primary"
            >{{"setting.ALL" | translate}}</md-radio-button
            >
            <md-radio-button value="withFix" flex="30">
              With Fix
            </md-radio-button>
            <md-radio-button value="withoutFix" flex="30">
              Without Fix
            </md-radio-button>
          </md-radio-group>
        </div>
      </div>
      <div layout="row" class="mt-lg">
        <div flex="20" class="text-bold text-muted ph-lg">
          {{"scan.gridHeader.SEVERITY" | translate}}
        </div>
        <div flex="80">
          <md-radio-group layout="row" ng-model="advFilter.severityType">
            <md-radio-button value="all" flex="20" class="md-primary"
            >{{"setting.ALL" | translate}}</md-radio-button
            >
            <md-radio-button value="High" flex="30" class="md-warn">
              {{"scan.gridHeader.HIGH" | translate}}
            </md-radio-button>
            <md-radio-button value="Medium" flex="30" class="md-accent">
              {{"scan.gridHeader.MEDIUM" | translate}}
            </md-radio-button>
          </md-radio-group>
        </div>
      </div>
      <div layout="row" class="mt-sm">
        <div
          flex="20"
          class="text-bold text-muted ph-lg"
          style="margin-top: 20px"
        >
          <em class="fa fa-tag text-action mr-sm"></em>Score
        </div>
        <div flex="20" uib-dropdown style="margin-top: 20px">
          <div uib-dropdown-toggle>
            <div>
              <label class="text-gray-label hand"
              >{{advFilter.scoreType}}</label
              >
              <em
                class="fa fa-caret-down text-action ml-sm"
                ng-click="toggleCollapse()"
              ></em>
            </div>
          </div>
          <ul
            class="dropdown-menu"
            uib-dropdown-menu
            role="menu"
            aria-labelledby="single-button"
          >
            <li role="menuitem">
              <a ng-click="setScoreType('V2')">V2</a>
            </li>
            <li role="menuitem">
              <a ng-click="setScoreType('V3')">V3</a>
            </li>
          </ul>
        </div>
        <div flex="50" ng-show="advFilter.scoreType==='V2'">
          <rzslider
            class="custom-slider"
            rz-slider-model="advFilter.sliderV2.minValue"
            rz-slider-high="advFilter.sliderV2.maxValue"
            rz-slider-options="slider.options"
          >
          </rzslider>
        </div>
        <div flex="50" ng-show="advFilter.scoreType==='V3'">
          <rzslider
            class="custom-slider"
            rz-slider-model="advFilter.sliderV3.minValue"
            rz-slider-high="advFilter.sliderV3.maxValue"
            rz-slider-options="slider.options"
          >
          </rzslider>
        </div>
        <div flex="10" style="margin-top: 20px;margin-left: 45px">
          <em class="fa fa-plus pl-lg text-action" ng-click="setScore()"></em>
        </div>
      </div>
      <md-content
        class=""
        layout="column"
        style="background-color: transparent"
        ng-if="scores.length"
      >
        <md-chips ng-model="scores" md-on-remove="removeScore($chip)">
          <md-chip-template>
            <strong class="text-muted mr-sm">{{$chip.name}}</strong>
          </md-chip-template>
        </md-chips>
      </md-content>

      <div layout="row">
        <div flex="20" class="pl-lg mt text-bold text-muted">
          {{"scan.gridHeader.DOMAIN" | translate}}
        </div>
        <div flex="20" uib-dropdown style="margin-top: 10px">
          <div uib-dropdown-toggle>
            <div>
              <label class="text-gray-label hand"
              >{{advFilter.matchType4Ns.name}}</label
              >
              <em
                class="fa fa-caret-down text-action ml-sm"
                ng-click="toggleCollapse()"
              ></em>
            </div>
          </div>
          <ul
            class="dropdown-menu"
            uib-dropdown-menu
            role="menu"
            aria-labelledby="single-button"
          >
            <li role="menuitem" ng-repeat="matchType in matchTypes">
              <a ng-click="setMatchType4Ns(matchType)">{{matchType.name}}</a>
            </li>
          </ul>
        </div>
        <div flex="50" class="fancy-tag-input">
          <tags-input
            id="domain"
            ng-model="advFilter.selectedDomains"
            display-property="name"
            class="auto-complete"
            placeholder="{{'securityEvent.DOMAIN_PLACEHOLDER' | translate}}"
            add-from-autocomplete-only="false"
          >
            <auto-complete
              source="loadTags($query)"
              min-length="1"
              max-results-to-show="128"
              max-length="{{'general.FILTER_MAX_LEN' | translate}}">
            </auto-complete>
          </tags-input>
        </div>
      </div>

      <div layout="row">
        <div flex="20" class="pl-lg mt" uib-dropdown>
          <div uib-dropdown-toggle>
            <div>
              <label class="text-muted hand">{{advFilter.entityType}}</label>
              <em
                class="fa fa-caret-down text-action ml-sm"
                ng-click="toggleCollapse()"
              ></em>
            </div>
          </div>
          <ul
            class="dropdown-menu"
            uib-dropdown-menu
            role="menu"
            aria-labelledby="single-button"
          >
            <li role="menuitem" ng-repeat="entity in advFilter.entities">
              <a ng-click="setEntity(entity)">{{entity}}</a>
            </li>
          </ul>
        </div>
        <div flex="20" uib-dropdown style="margin-top: 10px">
          <div uib-dropdown-toggle>
            <div>
              <label class="text-gray-label hand"
              >{{advFilter.matchType.name}}</label
              >
              <em
                class="fa fa-caret-down text-action ml-sm"
                ng-click="toggleCollapse()"
              ></em>
            </div>
          </div>
          <ul
            class="dropdown-menu"
            uib-dropdown-menu
            role="menu"
            aria-labelledby="single-button"
          >
            <li role="menuitem" ng-repeat="matchType in matchTypes">
              <a ng-click="setMatchType(matchType)">{{matchType.name}}</a>
            </li>
          </ul>
        </div>
        <div
          flex="50"
          class="text-bold text-muted"
          ng-if="advFilter.entityType==='Service'"
        >
          <md-input-container class="md-block mt0 mb0" md-no-float="">
            <input
              ng-model="advFilter.serviceName"
              maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
            />
          </md-input-container>
        </div>
        <div
          flex="50"
          class="text-bold text-muted"
          ng-if="advFilter.entityType==='Image'"
        >
          <md-input-container class="md-block mt0 mb0" md-no-float="">
            <input
              ng-model="advFilter.imageName"
              maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
            />
          </md-input-container>
        </div>
        <div
          flex="50"
          class="text-bold text-muted"
          ng-if="advFilter.entityType==='Node'"
        >
          <md-input-container class="md-block mt0 mb0" md-no-float="">
            <input
              ng-model="advFilter.nodeName"
              maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
            />
          </md-input-container>
        </div>
        <div
          flex="50"
          class="text-bold text-muted"
          ng-if="advFilter.entityType==='Container'"
        >
          <md-input-container class="md-block mt0 mb0" md-no-float="">
            <input
              ng-model="advFilter.containerName"
              maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
            />
          </md-input-container>
        </div>
        <div flex="10" class="mt" style="margin-left: 45px">
          <em
            class="fa fa-plus pl-lg text-action"
            ng-click="setEntityName()"
          ></em>
        </div>
      </div>
      <span
        class="help-block"
        ng-if="!entities.length"
      >{{"scan.CONDITION_HINT" | translate}}</span>
      <md-content
        class="mt-sm"
        layout="column"
        style="background-color: transparent"
        ng-if="entities.length"
      >
        <md-chips ng-model="entities" md-on-remove="removeEntity($chip)">
          <md-chip-template>
            <strong class="text-muted mr-sm">{{$chip.name}}</strong>
          </md-chip-template>
        </md-chips>
      </md-content>
      <button
        ng-click="resetAdvFilter()"
        class="btn btn-wide btn-default pull-right mt-sm"
      >
        {{'enum.RESET' | translate}}
      </button>
      <button
        ng-click="applyAdvFilter()" ng-disabled="advFilterForm.$invalid"
        class="btn btn-wide btn-default pull-right mr-lg mt-sm"
      >
        {{'securityEvent.APPLY' | translate}}
      </button>
    </form>
  </div>

  <div
    class="dataBox topLeftLimited pt0"
    ng-show="onContainer"
    ng-cloak
  >
    <div id="containerDetails">
      <div class="col-sm-12 ph0">
        <button
          class="btn btn-xs btn-link pull-right mt-sm"
          ng-click="onContainer=!onContainer"
        >
          <em class="fa fa-times fa-lg text-muted"></em>
        </button>
      </div>
      <uib-tabset justified="true" id="nodeBox">
        <uib-tab index="0">
          <uib-tab-heading>
            {{'enum.SUMMARY' | translate}}
          </uib-tab-heading>
          <ul class="mda-list">
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-credit-card text-muted fa-lg"></em>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'network.nodeDetails.NAME'}}"></h3>
                <small class="text-muted auto-hide" style="display:block; width: 250px;"
                       uib-tooltip="{{container.display_name}}"
                       tooltip-enable="false"
                       show-tooltip-on-text-overflow>
                  {{container.display_name}}
                </small>
              </div>
            </li>
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-building-o text-muted fa-lg"></em>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'group.gridHeader.DOMAIN'}}"></h3>
                <small class="text-muted auto-hide" style="display:block; width: 250px;"
                       uib-tooltip="{{container.domain}}"
                       tooltip-enable="false"
                       show-tooltip-on-text-overflow>
                  {{container.domain}}
                </small>
              </div>
            </li>
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-gears text-muted fa-lg"></em>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'network.gridHeader.SERVICE'}}"></h3>
                <small class="text-muted mr-lg auto-hide" style="display:block; width: 250px;"
                       uib-tooltip="{{container.service}}"
                       tooltip-enable="false"
                       show-tooltip-on-text-overflow>
                  {{container.service}}
                </small>
              </div>
            </li>
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-shield text-muted fa-lg"></em>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'network.nodeDetails.STATE'}}"></h3>
                <small
                  class="text-muted mr-lg"
                  ng-if="container.state !== 'quarantined'"
                >
                  {{container.state}}
                </small>
                <small
                  class="text-danger mr-lg"
                  ng-if="container.state === 'quarantined'"
                >
                  {{container.state}}:&nbsp; {{container.quarantine_reason}}
                </small>
              </div>
            </li>
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-server text-muted fa-lg" />
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'network.nodeDetails.ON_NODE'}}" />
                <small style="display:block; width: 250px;"
                       uib-tooltip="{{container.host_name}}"
                       tooltip-enable="false"
                       show-tooltip-on-text-overflow>
                  <a ui-sref="app.hosts({nodeId: container.host_id})">
                    {{container.host_name}}
                  </a>
                </small>
              </div>
            </li>
          </ul>
        </uib-tab>
        <uib-tab index="1">
          <uib-tab-heading>
            {{'enum.DETAIL' | translate}}
          </uib-tab-heading>
          <ul class="mda-list">
            <li
              class="mda-list-item"
              ng-if="!container.children || container.children.length <= 1"
            >
              <div class="mda-list-item-icon ">
                <em class="fa fa-code text-muted fa-lg" />
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'network.nodeDetails.APPLICATIONS'}}"></h3>
                <div
                  class="row"
                  ng-repeat="(name, ports) in container.app_ports"
                >
                  <div class="col-sm-12 text-left">
                    <strong class="text-muted mr-lg"> {{name}} </strong>
                    <small class="text-muted auto-hide" style="display:block; width: 200px;"
                           uib-tooltip="{{ports}}"
                           tooltip-enable="false"
                           show-tooltip-on-text-overflow>
                      {{ports}}
                    </small>
                  </div>
                </div>
              </div>
            </li>
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em
                  class="fa fa-stop-circle-o text-muted"
                  style="font-size: 1.5em;"
                  ng-if="container.children && container.children.length > 1"
                ></em>
                <em
                  class="fa fa-archive text-muted"
                  ng-if="!container.children ||
                container.children.length <= 1"
                ></em>
              </div>
              <div
                class="mda-list-item-text pb0"
                ng-if="container.children && container.children.length > 1"
              >
                <h3 translate="{{'network.nodeDetails.POD'}}"></h3>
                <div
                  class="row"
                  ng-repeat="child in container.children | filter:{state: '!exit'}"
                >
                  <div
                    class="text-muted text-bold pl-lg"
                    style="display: inline-block"
                  >
                    <em class="fa fa-square-o text-muted mr-sm"></em>
                    {{child.display_name | limitTo:
                    35}}{{child.display_name.length > 35 ? '...' : ''}}
                  </div>
                  <label
                    class="label label-info-tran ml-lg"
                    ng-if="child.service_mesh_sidecar"
                  >
                    Sidecar
                  </label>
                  <div class="row" ng-repeat="(name, ports) in child.app_ports">
                    <div class="col-sm-12 text-left">
                      <em class="fa fa-code text-muted ml-xl mr-sm pull-left"></em>
                      <small class="text-muted text-sm mr-lg pull-left"> {{name}}</small>
                      <small class="text-muted auto-hide pull-left" style="display:block; width: 160px;"
                             uib-tooltip="{{ports}}"
                             tooltip-enable="false"
                             show-tooltip-on-text-overflow>
                        {{ports}}
                      </small>
                    </div>
                  </div>
                  <div class="row">
                    <em class="fa fa-archive text-muted ml-xl pl-lg mr-sm pull-left"></em>
                    <small class="text-muted auto-hide pull-left"  style="display:block; width: 200px;"
                           uib-tooltip="{{child.image}}"
                           tooltip-enable="false"
                           show-tooltip-on-text-overflow>
                      {{child.image}}
                    </small>
                  </div>
                </div>
              </div>
              <div
                class="mda-list-item-text pb0"
                ng-if="!container.children  ||
               container.children.length <= 1"
              >
                <h3 translate="{{'network.nodeDetails.IMAGE'}}"></h3>
                <div class="row" ng-repeat="image in container.images" style="width: 250px;">
                  <small class="text-muted pl-lg auto-hide" style="display:block;"
                         uib-tooltip="{{image}}"
                         tooltip-enable="false"
                         show-tooltip-on-text-overflow>
                    {{image}}
                  </small>
                </div>
              </div>
            </li>
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-clone text-muted fa-lg"></em>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'sidebar.nav.GROUP'}}"></h3>
                <div class="row" ng-repeat="group in container.groups" style="width: 250px;">
                  <small class="text-muted pl-lg" style="display:block;"
                         uib-tooltip="{{group}}"
                         tooltip-enable="false"
                         show-tooltip-on-text-overflow>
                    {{group}}
                  </small>
                </div>
              </div>
            </li>
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-map-marker text-muted fa-lg"></em>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'network.nodeDetails.IP'}}"></h3>
                <div
                  class="row"
                  ng-repeat="(name, nets) in container.interfaces"
                >
                  <div class="col-sm-3 text-left">
                    <strong class="text-muted"> {{name}} </strong>
                  </div>
                  <div class="col-sm-8  col-sm-offset-1 text-muted">
                    <div ng-repeat="net in nets">
                      <small>{{net.ip}}</small>
                    </div>
                  </div>
                </div>
              </div>
            </li>

            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-calendar-plus-o text-muted fa-lg"></em>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'controllers.detail.STARTED_AT'}}" />
                <small class="text-muted"
                >{{container.started_at | date:'MMM dd, y HH:mm:ss'}}
                </small>
              </div>
            </li>
            <li class="mda-list-item">
              <div class="mda-list-item-icon ">
                <em class="fa fa-calendar-check-o text-muted fa-lg"></em>
              </div>
              <div class="mda-list-item-text pb0">
                <h3 translate="{{'network.nodeDetails.SECURED_AT'}}"></h3>
                <small class="text-muted"
                >{{container.secured_at | date:'MMM dd, y HH:mm:ss'}}
                </small>
              </div>
            </li>
          </ul>
        </uib-tab>
      </uib-tabset>
    </div>
  </div>

  <div class="dataBox topLeftLimited pt0" ng-show="onHost" ng-cloak style="min-width: 350px">
    <button class="btn btn-xs btn-link pull-right mt-sm" ng-click="onHost=!onHost">
      <em class="fa fa-times fa-lg text-muted"></em>
    </button>
    <div>
      <h4 class="text-muted" translate="{{'network.hostDetails.TITLE'}}"></h4>
      <ul class="mda-list">
        <li class="mda-list-item">
          <div class="mda-list-item-icon ">
            <em class="fa fa-credit-card text-muted fa-lg"></em>
          </div>
          <div class="mda-list-item-text pb0">
            <h3 translate="{{'network.nodeDetails.NAME'}}"></h3>
            <small class="text-muted">
              {{host.name | limitTo: 35}}{{host.name.length > 35 ?
              '...' : ''}}
            </small>
          </div>
        </li>
        <li class="mda-list-item">
          <div class="mda-list-item-icon ">
            <em class="fa fa-building-o text-muted fa-lg"></em>
          </div>
          <div class="mda-list-item-text pb0">
            <h3 translate="{{'nodes.detail.OS'}}"></h3>
            <small class="text-muted">
              {{host.os | limitTo: 35}}{{host.os.length > 35 ? '...' : ''}}
            </small>
          </div>
        </li>
        <li class="mda-list-item">
          <div class="mda-list-item-icon ">
            <em class="fa fa-gears text-muted fa-lg"></em>
          </div>
          <div class="mda-list-item-text pb0">
            <h3 translate="{{'nodes.detail.NUM_OF_CPUS'}}"></h3>
            <small class="text-muted mr-lg">
              {{host.cpus}}
            </small>
          </div>
        </li>
        <li class="mda-list-item">
          <div class="mda-list-item-icon ">
            <em class="fa fa-shield text-muted fa-lg"></em>
          </div>
          <div class="mda-list-item-text pb0">
            <h3 translate="{{'nodes.detail.MEMORY'}}"></h3>
            <small class="text-muted mr-lg">
              {{host.memory | bytes}}
            </small>
          </div>
        </li>
        <li class="mda-list-item">
          <div class="mda-list-item-icon ">
            <em class="fa fa-server text-muted fa-lg"/>
          </div>
          <div class="mda-list-item-text pb0">
            <h3 translate="{{'nodes.detail.KERNEL_VERSION'}}"/>
            <small class="text-muted mr-lg">
              {{host.kernel}}
            </small>
          </div>
        </li>
        <li class="mda-list-item">
          <div class="mda-list-item-icon ">
            <em class="fa fa-bug text-muted fa-lg"/>
          </div>
          <div class="mda-list-item-text pb0">
            <h3 translate="{{'group.gridHeader.VULNERABILITIES'}}"/>
            <label class="label label-danger mr-sm" ng-if="host.scan_summary.high">
              {{host.scan_summary.high}}</label>
            <label class="label label-warning" ng-if="host.scan_summary.medium">
              {{host.scan_summary.medium}}</label>
            <a ui-sref="app.hosts({nodeId: host.id})"
               style="display: table-cell; font-size: 11px; line-height: 15px;"
               ng-if="host.scan_summary.high || host.scan_summary.medium">
              <em class="fa fa-external-link ml-lg"></em>
            </a>

            <label class="label label-success-tran"
                   ng-if="!host.scan_summary.high && !host.scan_summary.medium">
              <em class="fa fa-smile-o mr-sm"></em> Clean </label>
          </div>
        </li>
      </ul>
    </div>
  </div>

  <div id="legend" class="bottomRightLegend p-lg" ng-show="showLegend">
    <ul class="fa-ul">
      <li class="animated fadeInDown anim-delay-10 mv">
        <span class="label label-inverse">
          <em class="fa fa-archive mr-sm"></em>
          {{"scan.IMAGE_NOT_USED" | translate}}
        </span>
      </li>
      <li class="animated fadeInDown anim-delay-20 mv">
        <span class="label label-danger">
          <em class="fa fa-server mr-sm"></em>
          {{"scan.UNPROTECTED_NODE" | translate}}
        </span>
      </li>
      <li class="animated fadeInDown anim-delay-30 mv">
        <span class="label label-success">
          <em class="fa fa-square-o mr-sm"></em>
          {{"scan.PROTECTED_CONTAINER" | translate}}
        </span>
      </li>
    </ul>
  </div>
</div>
